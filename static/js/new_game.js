var Data={Data:{}},Fay={FFI:{}};Fay.FFI._Nullable=function(a){this.slot1=a};Fay.FFI._Nullable.prototype.instance="Nullable";Fay.FFI.Nullable=function(a){return new Fay$$$(function(){return new Fay.FFI._Nullable(a)})};Fay.FFI._Null=function(){};Fay.FFI._Null.prototype.instance="Null";Fay.FFI.Null=new Fay$$$(function(){return new Fay.FFI._Null});Fay.FFI._Defined=function(a){this.slot1=a};Fay.FFI._Defined.prototype.instance="Defined";Fay.FFI.Defined=function(a){return new Fay$$$(function(){return new Fay.FFI._Defined(a)})};
Fay.FFI._Undefined=function(){};Fay.FFI._Undefined.prototype.instance="Undefined";Fay.FFI.Undefined=new Fay$$$(function(){return new Fay.FFI._Undefined});
Fay$$objConcat(Fay$$fayToJsHash,{Nullable:function(a,b,c){var d={instance:"Nullable"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Null:function(a,b,c){return{instance:"Null"}},Defined:function(a,b,c){var d={instance:"Defined"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Undefined:function(a,b,c){return{instance:"Undefined"}}});
Fay$$objConcat(Fay$$jsToFayHash,{Nullable:function(a,b,c){return new Fay.FFI._Nullable(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Null:function(a,b,c){return new Fay.FFI._Null},Defined:function(a,b,c){return new Fay.FFI._Defined(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Undefined:function(a,b,c){return new Fay.FFI._Undefined}});var Prelude={_Just:function(a){this.slot1=a}};Prelude._Just.prototype.instance="Just";
Prelude.Just=function(a){return new Fay$$$(function(){return new Prelude._Just(a)})};Prelude._Nothing=function(){};Prelude._Nothing.prototype.instance="Nothing";Prelude.Nothing=new Fay$$$(function(){return new Prelude._Nothing});Prelude._Left=function(a){this.slot1=a};Prelude._Left.prototype.instance="Left";Prelude.Left=function(a){return new Fay$$$(function(){return new Prelude._Left(a)})};Prelude._Right=function(a){this.slot1=a};Prelude._Right.prototype.instance="Right";Prelude.Right=function(a){return new Fay$$$(function(){return new Prelude._Right(a)})};
Prelude.maybe=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof Prelude._Nothing)return a;if(Fay$$_(c)instanceof Prelude._Just){var d=Fay$$_(c).slot1;return Fay$$_(b)(d)}throw["unhandled case in maybe",[a,b,c]];})}}};Prelude.$62$$62$$61$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$bind(a)(b))})}};Prelude.$62$$62$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$then(a)(b))})}};
Prelude.$_return=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$return(Fay$$fayToJs(["unknown"],a))))})};Prelude.fail=new Fay$$$(function(){return Prelude.error});Prelude.when=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(a)?Fay$$_(Fay$$_(Fay$$then)(b))(Fay$$_(Fay$$$_return)(Fay$$unit)):Fay$$_(Fay$$$_return)(Fay$$unit)})}};
Prelude.unless=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(a)?Fay$$_(Fay$$$_return)(Fay$$unit):Fay$$_(Fay$$_(Fay$$then)(b))(Fay$$_(Fay$$$_return)(Fay$$unit))})}};Prelude.forM=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.sequence))(Fay$$_(Fay$$_(Prelude.map)(b))(a))})}};
Prelude.forM_=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(a);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(b)(d)))(Fay$$_(Fay$$_(Prelude.forM_)(c))(b))}if(null===Fay$$_(a))return Fay$$_(Fay$$$_return)(Fay$$unit);throw["unhandled case in forM_",[a,b]];})}};Prelude.mapM=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.sequence))(Fay$$_(Fay$$_(Prelude.map)(a))(b))})}};
Prelude.mapM_=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.mapM_)(a))(c))}if(null===Fay$$_(b))return Fay$$_(Fay$$$_return)(Fay$$unit);throw["unhandled case in mapM_",[a,b]];})}};Prelude.$61$$60$$60$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(b))(a)})}};Prelude.$_void=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(a))(Fay$$_(Fay$$$_return)(Fay$$unit))})};
Prelude.$62$$61$$62$=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(a)(c)))(b)})}}};Prelude.$60$$61$$60$=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(b)(c)))(a)})}}};Prelude.sequence=function(a){return new Fay$$$(function(){return function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.foldr)(function(a){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(a))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(c))(function(b){return Fay$$_(Fay$$$_return)(Fay$$_(Fay$$_(Fay$$cons)(a))(b))})})})}}))(Fay$$_(Fay$$$_return)(null)))(a)}()})};
Prelude.sequence_=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Fay$$$_return)(Fay$$unit);var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$then)(c))(Fay$$_(Prelude.sequence_)(b))}throw["unhandled case in sequence_",[a]];})};Prelude._GT=function(){};Prelude._GT.prototype.instance="GT";Prelude.GT=new Fay$$$(function(){return new Prelude._GT});Prelude._LT=function(){};Prelude._LT.prototype.instance="LT";Prelude.LT=new Fay$$$(function(){return new Prelude._LT});
Prelude._EQ=function(){};Prelude._EQ.prototype.instance="EQ";Prelude.EQ=new Fay$$$(function(){return new Prelude._EQ});Prelude.compare=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(b))?Prelude.GT:Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(b))?Prelude.LT:Prelude.EQ})}};Prelude.succ=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$add)(a))(1)})};Prelude.pred=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$sub)(a))(1)})};
Prelude.enumFrom=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Prelude.enumFrom)(Fay$$_(Fay$$_(Fay$$add)(a))(1)))})};Prelude.enumFromTo=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(b))?null:Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Fay$$_(Prelude.enumFromTo)(Fay$$_(Fay$$_(Fay$$add)(a))(1)))(b))})}};Prelude.enumFromBy=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Fay$$_(Prelude.enumFromBy)(Fay$$_(Fay$$_(Fay$$add)(a))(b)))(b))})}};
Prelude.enumFromThen=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.enumFromBy)(a))(Fay$$_(Fay$$_(Fay$$sub)(b))(a))})}};
Prelude.enumFromByTo=function(a){return function(b){return function(c){return new Fay$$$(function(){return function(){var d=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(c))?null:Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(d)(Fay$$_(Fay$$_(Fay$$add)(a))(b)))})},e=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(c))?null:Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(e)(Fay$$_(Fay$$_(Fay$$add)(a))(b)))})};return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(b))(0))?
Fay$$_(d)(a):Fay$$_(e)(a)}()})}}};Prelude.enumFromThenTo=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.enumFromByTo)(a))(Fay$$_(Fay$$_(Fay$$sub)(b))(a)))(c)})}}};Prelude.fromIntegral=function(a){return new Fay$$$(function(){return a})};Prelude.fromInteger=function(a){return new Fay$$$(function(){return a})};Prelude.not=function(a){return new Fay$$$(function(){return Fay$$_(a)?!1:!0})};Prelude.otherwise=!0;
Prelude.show=function(a){return new Fay$$$(function(){return Fay$$jsToFay_string(JSON.stringify(Fay$$fayToJs(["automatic"],a)))})};Prelude.error=function(a){return new Fay$$$(function(){throw Fay$$fayToJs_string(a);})};Prelude.$_undefined=new Fay$$$(function(){return Fay$$_(Prelude.error)(Fay$$list("Prelude.undefined"))});
Prelude.either=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof Prelude._Left){var d=Fay$$_(c).slot1;return Fay$$_(a)(d)}if(Fay$$_(c)instanceof Prelude._Right)return d=Fay$$_(c).slot1,Fay$$_(b)(d);throw["unhandled case in either",[a,b,c]];})}}};Prelude.until=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(a)(c))?c:Fay$$_(Fay$$_(Fay$$_(Prelude.until)(a))(b))(Fay$$_(b)(c))})}}};
Prelude.$36$$33$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$seq)(b))(Fay$$_(a)(b))})}};Prelude.$_const=function(a){return function(b){return new Fay$$$(function(){return a})}};Prelude.id=function(a){return new Fay$$$(function(){return a})};Prelude.$46$=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(a)(Fay$$_(b)(c))})}}};Prelude.$36$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(a)(b)})}};
Prelude.flip=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(a)(c))(b)})}}};Prelude.curry=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(a)(Fay$$list([b,c]))})}}};Prelude.uncurry=function(a){return function(b){return new Fay$$$(function(){var c;if(Fay$$listLen(Fay$$_(b),2)){c=Fay$$index(0,Fay$$_(b));var d=Fay$$index(1,Fay$$_(b));c=Fay$$_(Fay$$_(a)(c))(d)}else throw["unhandled case",b];return c})}};
Prelude.snd=function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),2))return Fay$$index(1,Fay$$_(a));throw["unhandled case in snd",[a]];})};Prelude.fst=function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),2))return Fay$$index(0,Fay$$_(a));throw["unhandled case in fst",[a]];})};
Prelude.div=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(d))(0)))(Fay$$_(Fay$$_(Fay$$lt)(c))(0))))return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.quot)(Fay$$_(Fay$$_(Fay$$sub)(d))(1)))(c)))(1);if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(d))(0)))(Fay$$_(Fay$$_(Fay$$gt)(c))(0))))return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.quot)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c)))(1);c=b;d=a;return Fay$$_(Fay$$_(Prelude.quot)(d))(c)})}};
Prelude.mod=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(d))(0)))(Fay$$_(Fay$$_(Fay$$lt)(c))(0))))return Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.rem)(Fay$$_(Fay$$_(Fay$$sub)(d))(1)))(c)))(c)))(1);if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(d))(0)))(Fay$$_(Fay$$_(Fay$$gt)(c))(0))))return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.rem)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c)))(c)))(1);
c=b;d=a;return Fay$$_(Fay$$_(Prelude.rem)(d))(c)})}};
Prelude.divMod=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(d))(0)))(Fay$$_(Fay$$_(Fay$$lt)(c))(0))))return function(a){if(Fay$$listLen(Fay$$_(a),2)){var b=Fay$$index(0,Fay$$_(a));a=Fay$$index(1,Fay$$_(a));return Fay$$list([Fay$$_(Fay$$_(Fay$$sub)(b))(1),Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$add)(a))(c)))(1)])}throw["unhandled case",a];}(Fay$$_(Fay$$_(Prelude.quotRem)(Fay$$_(Fay$$_(Fay$$sub)(d))(1)))(c));if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(d))(0)))(Fay$$_(Fay$$_(Fay$$gt)(c))(1))))return function(a){if(Fay$$listLen(Fay$$_(a),
2)){var b=Fay$$index(0,Fay$$_(a));a=Fay$$index(1,Fay$$_(a));return Fay$$list([Fay$$_(Fay$$_(Fay$$sub)(b))(1),Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$add)(a))(c)))(1)])}throw["unhandled case",a];}(Fay$$_(Fay$$_(Prelude.quotRem)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c));c=b;d=a;return Fay$$_(Fay$$_(Prelude.quotRem)(d))(c)})}};
Prelude.min=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.min(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(Fay$$fayToJs(["unknown"],b))))})}};Prelude.max=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.max(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(Fay$$fayToJs(["unknown"],b))))})}};Prelude.recip=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(1))(a)})};Prelude.negate=function(a){return new Fay$$$(function(){return-Fay$$_(a)})};
Prelude.abs=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?Fay$$_(Prelude.negate)(a):a})};Prelude.signum=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(0))?1:Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(a))(0))?0:-1})};Prelude.pi=new Fay$$$(function(){return Fay$$jsToFay_double(Math.PI)});Prelude.exp=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.exp(Fay$$fayToJs_double(a)))})};Prelude.sqrt=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.sqrt(Fay$$fayToJs_double(a)))})};
Prelude.log=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.log(Fay$$fayToJs_double(a)))})};Prelude.$42$$42$=new Fay$$$(function(){return Prelude.unsafePow});Prelude.$94$$94$=new Fay$$$(function(){return Prelude.unsafePow});Prelude.unsafePow=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.pow(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(Fay$$fayToJs(["unknown"],b))))})}};
Prelude.$94$=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(c))(0)))return Fay$$_(Prelude.error)(Fay$$list("(^): negative exponent"));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(0)))return 1;if(Fay$$_(Fay$$_(Prelude.even)(c)))return function(){return new Fay$$$(function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$94$)(d))(Fay$$_(Fay$$_(Prelude.quot)(c))(2))});return Fay$$_(Fay$$_(Fay$$mult)(a))(a)})}();c=b;d=a;return Fay$$_(Fay$$_(Fay$$mult)(d))(Fay$$_(Fay$$_(Prelude.$94$)(d))(Fay$$_(Fay$$_(Fay$$sub)(c))(1)))})}};
Prelude.logBase=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.log)(b)))(Fay$$_(Prelude.log)(a))})}};Prelude.sin=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.sin(Fay$$fayToJs_double(a)))})};Prelude.tan=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.tan(Fay$$fayToJs_double(a)))})};Prelude.cos=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.cos(Fay$$fayToJs_double(a)))})};
Prelude.asin=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.asin(Fay$$fayToJs_double(a)))})};Prelude.atan=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.atan(Fay$$fayToJs_double(a)))})};Prelude.acos=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.acos(Fay$$fayToJs_double(a)))})};Prelude.sinh=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Prelude.exp)(a)))(Fay$$_(Prelude.exp)(-Fay$$_(a)))))(2)})};
Prelude.tanh=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Prelude.exp)(a)}),c=new Fay$$$(function(){return Fay$$_(Prelude.exp)(-Fay$$_(a))});return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(b))(c)))(Fay$$_(Fay$$_(Fay$$add)(b))(c))})}()})};Prelude.cosh=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Prelude.exp)(a)))(Fay$$_(Prelude.exp)(-Fay$$_(a)))))(2)})};
Prelude.asinh=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$add)(a))(Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.$42$$42$)(a))(2)))(1))))})};Prelude.atanh=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$add)(1))(a)))(Fay$$_(Fay$$_(Fay$$sub)(1))(a)))))(2)})};Prelude.acosh=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$add)(a))(Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.$42$$42$)(a))(2)))(1))))})};
Prelude.properFraction=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Prelude.truncate)(a)});return Fay$$list([b,Fay$$_(Fay$$_(Fay$$sub)(a))(Fay$$_(Prelude.fromIntegral)(b))])})}()})};Prelude.truncate=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?Fay$$_(Prelude.ceiling)(a):Fay$$_(Prelude.floor)(a)})};Prelude.round=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.round(Fay$$fayToJs_double(a)))})};
Prelude.ceiling=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.ceil(Fay$$fayToJs_double(a)))})};Prelude.floor=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.floor(Fay$$fayToJs_double(a)))})};Prelude.subtract=new Fay$$$(function(){return Fay$$_(Prelude.flip)(Fay$$sub)});Prelude.even=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(Prelude.rem)(a))(2)))(0)})};Prelude.odd=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.not)(Fay$$_(Prelude.even)(a))})};
Prelude.gcd=function(a){return function(b){return new Fay$$$(function(){return function(){var c=function(a){return function(b){return new Fay$$$(function(){if(0===Fay$$_(b)){var f=a;return f}f=a;return Fay$$_(Fay$$_(c)(b))(Fay$$_(Fay$$_(Prelude.rem)(f))(b))})}};return Fay$$_(Fay$$_(c)(Fay$$_(Prelude.abs)(a)))(Fay$$_(Prelude.abs)(b))}()})}};
Prelude.quot=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(b))(0))?Fay$$_(Prelude.error)(Fay$$list("Division by zero")):Fay$$_(Fay$$_(Prelude.quot$39$)(a))(b)})}};Prelude.quot$39$=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_int(~~(Fay$$fayToJs_int(a)/Fay$$fayToJs_int(b)))})}};Prelude.quotRem=function(a){return function(b){return new Fay$$$(function(){return Fay$$list([Fay$$_(Fay$$_(Prelude.quot)(a))(b),Fay$$_(Fay$$_(Prelude.rem)(a))(b)])})}};
Prelude.rem=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(b))(0))?Fay$$_(Prelude.error)(Fay$$list("Division by zero")):Fay$$_(Fay$$_(Prelude.rem$39$)(a))(b)})}};Prelude.rem$39$=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs_int(a)%Fay$$fayToJs_int(b))})}};Prelude.lcm=function(a){return function(b){return new Fay$$$(function(){return 0===Fay$$_(b)||0===Fay$$_(a)?0:Fay$$_(Prelude.abs)(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Prelude.quot)(a))(Fay$$_(Fay$$_(Prelude.gcd)(a))(b))))(b))})}};
Prelude.find=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Prelude.Just)(d):Fay$$_(Fay$$_(Prelude.find)(a))(c)}if(null===Fay$$_(b))return Prelude.Nothing;throw["unhandled case in find",[a,b]];})}};
Prelude.filter=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.filter)(a))(c)):Fay$$_(Fay$$_(Prelude.filter)(a))(c)}if(null===Fay$$_(b))return null;throw["unhandled case in filter",[a,b]];})}};Prelude.$_null=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?!0:!1})};
Prelude.map=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.map)(a))(c))}throw["unhandled case in map",[a,b]];})}};Prelude.nub=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.nub$39$)(a))(null)})};
Prelude.nub$39$=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(a))return null;var c=Fay$$_(a);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.elem)(d))(b))?Fay$$_(Fay$$_(Prelude.nub$39$)(c))(b):Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.nub$39$)(c))(Fay$$_(Fay$$_(Fay$$cons)(d))(b)))}throw["unhandled case in nub'",[a,b]];})}};
Prelude.elem=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(Fay$$_(Fay$$eq)(a))(d)))(Fay$$_(Fay$$_(Prelude.elem)(a))(c))}if(null===Fay$$_(b))return!1;throw["unhandled case in elem",[a,b]];})}};Prelude.notElem=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Prelude.not)(Fay$$_(Fay$$_(Prelude.elem)(a))(b))})}};Prelude.sort=new Fay$$$(function(){return Fay$$_(Prelude.sortBy)(Prelude.compare)});
Prelude.sortBy=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Fay$$_(Prelude.insertBy)(a)))(null)})};
Prelude.insertBy=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return Fay$$list([d])}d=b;if(null===Fay$$_(c))d=Fay$$list([d]);else{var e=Fay$$_(c);if(e instanceof Fay$$Cons)var f=e.car,e=e.cdr,g=Fay$$_(Fay$$_(a)(d))(f),d=Fay$$_(g)instanceof Prelude._GT?Fay$$_(Fay$$_(Fay$$cons)(f))(Fay$$_(Fay$$_(Fay$$_(Prelude.insertBy)(a))(d))(e)):Fay$$_(Fay$$_(Fay$$cons)(d))(c);else throw["unhandled case",c];}return d})}}};
Prelude.conc=function(a){return function(b){return new Fay$$$(function(){var c=b,d=Fay$$_(a);if(d instanceof Fay$$Cons){var e=d.car,d=d.cdr;return Fay$$_(Fay$$_(Fay$$cons)(e))(Fay$$_(Fay$$_(Prelude.conc)(d))(c))}c=b;if(null===Fay$$_(a))return c;throw["unhandled case in conc",[a,b]];})}};Prelude.concat=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Prelude.conc))(null)});Prelude.concatMap=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.$43$$43$))(a)))(null)})};
Prelude.foldr=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return d}d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=b;return Fay$$_(Fay$$_(a)(e))(Fay$$_(Fay$$_(Fay$$_(Prelude.foldr)(a))(d))(f))}throw["unhandled case in foldr",[a,b,c]];})}}};
Prelude.foldr1=function(a){return function(b){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(b),1)){var c=Fay$$index(0,Fay$$_(b));return c}var d=Fay$$_(b);if(d instanceof Fay$$Cons)return c=d.car,d=d.cdr,Fay$$_(Fay$$_(a)(c))(Fay$$_(Fay$$_(Prelude.foldr1)(a))(d));if(null===Fay$$_(b))return Fay$$_(Prelude.error)(Fay$$list("foldr1: empty list"));throw["unhandled case in foldr1",[a,b]];})}};
Prelude.foldl=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return d}d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=b;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(a))(Fay$$_(Fay$$_(a)(d))(e)))(f)}throw["unhandled case in foldl",[a,b,c]];})}}};
Prelude.foldl1=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(a))(d))(c)}if(null===Fay$$_(b))return Fay$$_(Prelude.error)(Fay$$list("foldl1: empty list"));throw["unhandled case in foldl1",[a,b]];})}};Prelude.$43$$43$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.conc)(a))(b)})}};
Prelude.$33$$33$=function(a){return function(b){return new Fay$$$(function(){return function(){var c=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("(!!): index too large"));if(0===Fay$$_(b)){var f=Fay$$_(a);if(f instanceof Fay$$Cons)return f.car}f=Fay$$_(a);if(f instanceof Fay$$Cons)return f=f.cdr,Fay$$_(Fay$$_(c)(f))(Fay$$_(Fay$$_(Fay$$sub)(b))(1));throw["unhandled case in go",[a,b]];})}};return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(b))(0))?
Fay$$_(Prelude.error)(Fay$$list("(!!): negative index")):Fay$$_(Fay$$_(c)(a))(b)}()})}};Prelude.head=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("head: empty list"));var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b.car;throw["unhandled case in head",[a]];})};
Prelude.tail=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("tail: empty list"));var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b.cdr;throw["unhandled case in tail",[a]];})};
Prelude.init=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("init: empty list"));if(Fay$$listLen(Fay$$_(a),1))return Fay$$index(0,Fay$$_(a)),null;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$cons)(c))(Fay$$_(Prelude.init)(b))}throw["unhandled case in init",[a]];})};
Prelude.last=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("last: empty list"));if(Fay$$listLen(Fay$$_(a),1))return Fay$$index(0,Fay$$_(a));var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b=b.cdr,Fay$$_(Prelude.last)(b);throw["unhandled case in last",[a]];})};Prelude.iterate=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(b))(Fay$$_(Fay$$_(Prelude.iterate)(a))(Fay$$_(a)(b)))})}};Prelude.repeat=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Prelude.repeat)(a))})};
Prelude.replicate=function(a){return function(b){return new Fay$$$(function(){return 0===Fay$$_(a)?null:Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?null:Fay$$_(Fay$$_(Fay$$cons)(b))(Fay$$_(Fay$$_(Prelude.replicate)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(b))})}};Prelude.cycle=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?Fay$$_(Prelude.error)(Fay$$list("cycle: empty list")):function(){var b=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$43$$43$)(a))(b)});return b}()})};
Prelude.take=function(a){return function(b){return new Fay$$$(function(){if(0===Fay$$_(a)||null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?null:Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.take)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(c))}throw["unhandled case in take",[a,b]];})}};
Prelude.drop=function(a){return function(b){return new Fay$$$(function(){var c=b;if(0===Fay$$_(a))return c;if(null===Fay$$_(b))return null;c=Fay$$_(b);if(c instanceof Fay$$Cons)return c=c.cdr,Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?b:Fay$$_(Fay$$_(Prelude.drop)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(c);throw["unhandled case in drop",[a,b]];})}};
Prelude.splitAt=function(a){return function(b){return new Fay$$$(function(){var c=b;if(0===Fay$$_(a))return Fay$$list([null,c]);if(null===Fay$$_(b))return Fay$$list([null,null]);c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;if(Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0)))d=Fay$$list([null,Fay$$_(Fay$$_(Fay$$cons)(d))(c)]);else{var e=Fay$$_(Fay$$_(Prelude.splitAt)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(c);if(Fay$$listLen(Fay$$_(e),2))c=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),d=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(d))(c),
e]);else throw["unhandled case",e];}return d}throw["unhandled case in splitAt",[a,b]];})}};Prelude.takeWhile=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.takeWhile)(a))(c)):null}throw["unhandled case in takeWhile",[a,b]];})}};
Prelude.dropWhile=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Fay$$_(Prelude.dropWhile)(a))(c):Fay$$_(Fay$$_(Fay$$cons)(d))(c)}throw["unhandled case in dropWhile",[a,b]];})}};
Prelude.span=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return Fay$$list([null,null]);var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;if(Fay$$_(Fay$$_(a)(d))){var e=Fay$$_(Fay$$_(Prelude.span)(a))(c);if(Fay$$listLen(Fay$$_(e),2))c=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),d=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(d))(c),e]);else throw["unhandled case",e];}else d=Fay$$list([null,Fay$$_(Fay$$_(Fay$$cons)(d))(c)]);return d}throw["unhandled case in span",
[a,b]];})}};Prelude.$_break=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.span)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.not))(a))})};Prelude.zipWith=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=Fay$$_(b);if(d instanceof Fay$$Cons){var g=d.car,d=d.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(a)(g))(e)))(Fay$$_(Fay$$_(Fay$$_(Prelude.zipWith)(a))(d))(f))}}return null})}}};
Prelude.zipWith3=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){var e=Fay$$_(d);if(e instanceof Fay$$Cons){var f=e.car,g=e.cdr,e=Fay$$_(c);if(e instanceof Fay$$Cons){var h=e.car,k=e.cdr,e=Fay$$_(b);if(e instanceof Fay$$Cons){var l=e.car,e=e.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(Fay$$_(a)(l))(h))(f)))(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Prelude.zipWith3)(a))(e))(k))(g))}}}return null})}}}};
Prelude.zip=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,e=c.cdr,c=Fay$$_(a);if(c instanceof Fay$$Cons){var f=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$list([f,d])))(Fay$$_(Fay$$_(Prelude.zip)(c))(e))}}return null})}};
Prelude.zip3=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=Fay$$_(b);if(d instanceof Fay$$Cons){var g=d.car,h=d.cdr,d=Fay$$_(a);if(d instanceof Fay$$Cons){var k=d.car,d=d.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$list([k,g,e])))(Fay$$_(Fay$$_(Fay$$_(Prelude.zip3)(d))(h))(f))}}}return null})}}};
Prelude.unzip=function(a){return new Fay$$$(function(){var b=Fay$$_(a);if(b instanceof Fay$$Cons&&Fay$$listLen(Fay$$_(b.car),2)){var c=Fay$$index(0,Fay$$_(b.car)),d=Fay$$index(1,Fay$$_(b.car)),b=b.cdr;var e=Fay$$_(Prelude.unzip)(b);if(Fay$$listLen(Fay$$_(e),2))b=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),c=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(c))(b),Fay$$_(Fay$$_(Fay$$cons)(d))(e)]);else throw["unhandled case",e];return c}if(null===Fay$$_(a))return Fay$$list([null,null]);throw["unhandled case in unzip",
[a]];})};
Prelude.unzip3=function(a){return new Fay$$$(function(){var b=Fay$$_(a);if(b instanceof Fay$$Cons&&Fay$$listLen(Fay$$_(b.car),3)){var c=Fay$$index(0,Fay$$_(b.car)),d=Fay$$index(1,Fay$$_(b.car)),e=Fay$$index(2,Fay$$_(b.car)),b=b.cdr;var f=Fay$$_(Prelude.unzip3)(b);if(Fay$$listLen(Fay$$_(f),3))var b=Fay$$index(0,Fay$$_(f)),g=Fay$$index(1,Fay$$_(f)),f=Fay$$index(2,Fay$$_(f)),c=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(c))(b),Fay$$_(Fay$$_(Fay$$cons)(d))(g),Fay$$_(Fay$$_(Fay$$cons)(e))(f)]);else throw["unhandled case",f];
return c}if(null===Fay$$_(a))return Fay$$list([null,null,null]);throw["unhandled case in unzip3",[a]];})};
Prelude.lines=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?null:function(){return function(a){if(Fay$$listLen(Fay$$_(a),2)){var c=Fay$$index(0,Fay$$_(a));if(null===Fay$$_(Fay$$index(1,Fay$$_(a))))return Fay$$list([c])}if(Fay$$listLen(Fay$$_(a),2)){var c=Fay$$index(0,Fay$$_(a)),d=Fay$$_(Fay$$index(1,Fay$$_(a)));if(d instanceof Fay$$Cons)return a=d.cdr,Fay$$_(Fay$$_(Fay$$cons)(c))(Fay$$_(Prelude.lines)(a))}throw["unhandled case",a];}(Fay$$_(Fay$$_(Prelude.$_break)(function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(Fay$$_(Fay$$eq)(a))("\r")))(Fay$$_(Fay$$_(Fay$$eq)(a))("\n"))})}))(a))}()})};
Prelude.unlines=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return null;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Prelude.$43$$43$)(c))(Fay$$_(Fay$$_(Fay$$cons)("\n"))(Fay$$_(Prelude.unlines)(b)))}throw["unhandled case in unlines",[a]];})};
Prelude.words=function(a){return new Fay$$$(function(){return function(){var b=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.elem)(a))(Fay$$list(" \t\r\n\f\x0B"))})};return Fay$$_(function(a){return new Fay$$$(function(){var d;if(null===Fay$$_(a))d=null;else{var e=Fay$$_(Fay$$_(Prelude.$_break)(b))(a);if(Fay$$listLen(Fay$$_(e),2))d=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),d=Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Prelude.words)(e));else throw["unhandled case",e];}return d})})(Fay$$_(Fay$$_(Prelude.dropWhile)(b))(a))}()})};
Prelude.unwords=new Fay$$$(function(){return Fay$$_(Prelude.intercalate)(Fay$$list(" "))});Prelude.and=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return!0;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$and)(c))(Fay$$_(Prelude.and)(b))}throw["unhandled case in and",[a]];})};
Prelude.or=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return!1;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$or)(c))(Fay$$_(Prelude.or)(b))}throw["unhandled case in or",[a]];})};
Prelude.any=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return!1;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.any)(a))(c))}throw["unhandled case in any",[a,b]];})}};
Prelude.all=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return!0;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.all)(a))(c))}throw["unhandled case in all",[a,b]];})}};
Prelude.intersperse=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.prependToAll)(a))(c))}throw["unhandled case in intersperse",[a,b]];})}};
Prelude.prependToAll=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.prependToAll)(a))(c)))}throw["unhandled case in prependToAll",[a,b]];})}};Prelude.intercalate=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Prelude.concat)(Fay$$_(Fay$$_(Prelude.intersperse)(a))(b))})}};
Prelude.maximum=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?Fay$$_(Prelude.error)(Fay$$list("maximum: empty list")):Fay$$_(Fay$$_(Prelude.foldl1)(Prelude.max))(a)})};Prelude.minimum=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?Fay$$_(Prelude.error)(Fay$$list("minimum: empty list")):Fay$$_(Fay$$_(Prelude.foldl1)(Prelude.min))(a)})};Prelude.product=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(Fay$$mult))(1))(a)})};
Prelude.sum=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(Fay$$add))(0))(a)})};Prelude.scanl=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(Fay$$_(Fay$$cons)(b)),e;if(null===Fay$$_(c))e=null;else{var f=Fay$$_(c);if(f instanceof Fay$$Cons)e=f.car,f=f.cdr,e=Fay$$_(Fay$$_(Fay$$_(Prelude.scanl)(a))(Fay$$_(Fay$$_(a)(b))(e)))(f);else throw["unhandled case",c];}return d(e)})}}};
Prelude.scanl1=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.scanl)(a))(d))(c)}throw["unhandled case in scanl1",[a,b]];})}};
Prelude.scanr=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return Fay$$list([d])}d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=b;d=Fay$$_(Fay$$_(Fay$$_(Prelude.scanr)(a))(d))(f);f=Fay$$_(d);f instanceof Fay$$Cons?(d=f.car,f=f.cdr,e=Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(a)(e))(d)))(Fay$$_(Fay$$_(Fay$$cons)(d))(f))):e=Prelude.$_undefined;return e}throw["unhandled case in scanr",[a,b,c]];})}}};
Prelude.scanr1=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;if(Fay$$listLen(Fay$$_(b),1)){var c=Fay$$index(0,Fay$$_(b));return Fay$$list([c])}var d=Fay$$_(b);if(d instanceof Fay$$Cons){c=d.car;d=d.cdr;var d=Fay$$_(Fay$$_(Prelude.scanr1)(a))(d),e=Fay$$_(d);e instanceof Fay$$Cons?(d=e.car,e=e.cdr,c=Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(a)(c))(d)))(Fay$$_(Fay$$_(Fay$$cons)(d))(e))):c=Prelude.$_undefined;return c}throw["unhandled case in scanr1",[a,b]];
})}};Prelude.lookup=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return Prelude.Nothing;var c=Fay$$_(b);if(c instanceof Fay$$Cons&&Fay$$listLen(Fay$$_(c.car),2)){var d=Fay$$index(0,Fay$$_(c.car)),e=Fay$$index(1,Fay$$_(c.car)),c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(a))(d))?Fay$$_(Prelude.Just)(e):Fay$$_(Fay$$_(Prelude.lookup)(a))(c)}throw["unhandled case in lookup",[a,b]];})}};Prelude.length=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.length$39$)(0))(a)})};
Prelude.length$39$=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var c=c.cdr,d=a;return Fay$$_(Fay$$_(Prelude.length$39$)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c)}return d=a})}};
Prelude.reverse=function(a){return new Fay$$$(function(){var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$_(Prelude.reverse)(b)))(Fay$$list([c]))}if(null===Fay$$_(a))return null;throw["unhandled case in reverse",[a]];})};Prelude.print=function(a){return new Fay$$$(function(){var b=Fay$$Monad,c=Fay$$jsToFay,d=Fay$$fayToJs(["automatic"],a);console&&console.log&&console.log(d);return new b(c(["unknown"],void 0))})};
Prelude.putStrLn=function(a){return new Fay$$$(function(){var b=Fay$$Monad,c=Fay$$jsToFay,d=Fay$$fayToJs_string(a);console&&console.log&&console.log(d);return new b(c(["unknown"],void 0))})};Prelude.ifThenElse=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(a)?b:c})}}};
Fay$$objConcat(Fay$$fayToJsHash,{Just:function(a,b,c){var d={instance:"Just"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Nothing:function(a,b,c){return{instance:"Nothing"}},Left:function(a,b,c){var d={instance:"Left"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Right:function(a,b,c){var d={instance:"Right"};a=Fay$$fayToJs(b&&b[1]?b[1]:"automatic"===a[0]?
["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},GT:function(a,b,c){return{instance:"GT"}},LT:function(a,b,c){return{instance:"LT"}},EQ:function(a,b,c){return{instance:"EQ"}}});
Fay$$objConcat(Fay$$jsToFayHash,{Just:function(a,b,c){return new Prelude._Just(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Nothing:function(a,b,c){return new Prelude._Nothing},Left:function(a,b,c){return new Prelude._Left(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Right:function(a,b,c){return new Prelude._Right(Fay$$jsToFay(b&&b[1]?b[1]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},GT:function(a,b,c){return new Prelude._GT},
LT:function(a,b,c){return new Prelude._LT},EQ:function(a,b,c){return new Prelude._EQ}});var FFI={};Data.Nullable={};Data.Nullable.fromNullable=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Fay.FFI._Nullable){var b=Fay$$_(a).slot1;return Fay$$_(Prelude.Just)(b)}if(Fay$$_(a)instanceof Fay.FFI._Null)return Prelude.Nothing;throw["unhandled case in fromNullable",[a]];})};
Data.Nullable.toNullable=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var b=Fay$$_(a).slot1;return Fay$$_(Fay.FFI.Nullable)(b)}if(Fay$$_(a)instanceof Prelude._Nothing)return Fay.FFI.Null;throw["unhandled case in toNullable",[a]];})};Data.Text={};Data.Text.intercalate=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],b).join(Fay$$fayToJs(["user","Text",[]],a)))})}};
Data.Text.fromString=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_string(a))})};Data.Text.snoc=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a)+Fay$$fayToJs(["user","Char",[]],b))})}};Data.Text.cons=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Char",[]],a)+Fay$$fayToJs(["user","Text",[]],b))})}};
Data.Text.pack=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_string(a))})};Data.Text.unpack=function(a){return new Fay$$$(function(){return Fay$$jsToFay_string(Fay$$fayToJs(["user","Text",[]],a))})};Data.Text.append=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a)+Fay$$fayToJs(["user","Text",[]],b))})}};
Data.Text.$60$$62$=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a)+Fay$$fayToJs(["user","Text",[]],b))})}};Data.Text.length=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs(["user","Text",[]],a).length)})};Data.Text.$_null=function(a){return new Fay$$$(function(){return Fay$$jsToFay_bool(0==Fay$$fayToJs(["user","Text",[]],a).length)})};
Data.Text.take=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],b).substring(0,Fay$$fayToJs_int(a)))})}};Data.Text.drop=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],b).substring(Fay$$fayToJs_int(a)))})}};Data.Text.empty=new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],"")});
Data.Text.lines=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Text",[]]]],Fay$$fayToJs(["user","Text",[]],a).split("\n"))})};Data.Text.unlines=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],a).join("\n"))})};
Data.Text.isPrefixOf=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_bool(0==Fay$$fayToJs(["user","Text",[]],b).lastIndexOf(Fay$$fayToJs(["user","Text",[]],a),0))})}};Data.Text.intersperse=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],b).split("").join(Fay$$fayToJs(["user","Char",[]],a)))})}};
Data.Text.reverse=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a).split("").reverse().join(""))})};
Data.Text.stripSuffix=function(a){return function(b){return new Fay$$$(function(){return function(){return Fay$$_(Data.Nullable.fromNullable)(Fay$$_(Fay$$_(function(a){return function(b){return new Fay$$$(function(){var e=Fay$$jsToFay,f;f=Fay$$fayToJs(["user","Text",[]],a);var g=Fay$$fayToJs(["user","Text",[]],b);f=g.substring(g.length-f.length)==f?g.substring(0,g.length-f.length):null;return e(["nullable",[["user","Text",[]]]],f)})}})(a))(b))}()})}};
Data.Text.splitOn=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Text",[]]]],Fay$$fayToJs(["user","Text",[]],b).split(Fay$$fayToJs(["user","Char",[]],a)))})}};Data.Text.putStrLn=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],console.log("%s",Fay$$fayToJs(["user","Text",[]],a))))})};Data.Text.toShortest=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_double(a).toString())})};
Data.Text.showInt=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_int(a).toString())})};Data.Text.uncons=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Maybe",[["tuple",[["user","Char",[]],["user","Text",[]]]]]],Fay$$fayToJs(["user","Text",[]],a)[0]?{instance:"Just",slot1:[Fay$$fayToJs(["user","Text",[]],a)[0],Fay$$fayToJs(["user","Text",[]],a).slice(1)]}:{instance:"Nothing"})})};
Data.Text.head=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(!(c=Fay$$fayToJs(["user","Text",[]],a)[0]))throw Error("Data.Text.head: empty Text");return b(["user","Char",[]],c)})};Data.Text.last=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(Fay$$fayToJs(["user","Text",[]],a).length)c=Fay$$fayToJs(["user","Text",[]],a)[Fay$$fayToJs(["user","Text",[]],a).length-1];else throw Error("Data.Text.last: empty Text");return b(["user","Char",[]],c)})};
Data.Text.tail=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(Fay$$fayToJs(["user","Text",[]],a).length)c=Fay$$fayToJs(["user","Text",[]],a).slice(1);else throw Error("Data.Text.tail: empty Text");return b(["user","Text",[]],c)})};Data.Text.init=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(Fay$$fayToJs(["user","Text",[]],a).length)c=Fay$$fayToJs(["user","Text",[]],a).slice(0,-1);else throw Error("Data.Text.init: empty Text");return b(["user","Text",[]],c)})};
Data.Text.map=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],[].map.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["user","Char",[]]]],a)).join(""))})}};Data.Text.toLower=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a).toLowerCase())})};
Data.Text.toUpper=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a).toUpperCase())})};Data.Text.concat=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],a).join(""))})};
Data.Text.concatMap=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],[].map.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["user","Text",[]]]],a)).join(""))})}};Data.Text.any=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_bool(0<[].filter.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],a)).length)})}};
Data.Text.all=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_bool([].filter.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],a)).length==Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],a).length)})}};
Data.Text.maximum=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c=Fay$$fayToJs(["user","Text",[]],a);if(""===c)throw Error("Data.Text.maximum: empty string");for(var d=c[0];1<c.length;c++)c[1]>d&&(d=c[1]);return b(["user","Char",[]],d)})};Data.Text.minimum=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c=Fay$$fayToJs(["user","Text",[]],a);if(""===c)throw Error("Data.Text.maximum: empty string");for(var d=c[0];1<c.length;c++)c[1]<d&&(d=c[1]);return b(["user","Char",[]],d)})};
FFI.Types={};Data.Maybe={};Data.Maybe.isJust=function(a){return new Fay$$$(function(){return Fay$$_(a)instanceof Prelude._Nothing?!1:!0})};Data.Maybe.isNothing=function(a){return new Fay$$$(function(){return Fay$$_(a)instanceof Prelude._Nothing?!0:!1})};
Data.Maybe.fromJust=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Nothing)return Fay$$_(Prelude.error)(Fay$$list("Maybe.fromJust: Nothing"));if(Fay$$_(a)instanceof Prelude._Just)return Fay$$_(a).slot1;throw["unhandled case in fromJust",[a]];})};Data.Maybe.fromMaybe=function(a){return function(b){return new Fay$$$(function(){var c;if(Fay$$_(b)instanceof Prelude._Nothing)c=a;else if(Fay$$_(b)instanceof Prelude._Just)c=Fay$$_(b).slot1;else throw["unhandled case",b];return c})}};
Data.Maybe.maybeToList=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Nothing)return null;if(Fay$$_(a)instanceof Prelude._Just){var b=Fay$$_(a).slot1;return Fay$$list([b])}throw["unhandled case in maybeToList",[a]];})};Data.Maybe.listToMaybe=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Prelude.Nothing;var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b=b.car,Fay$$_(Prelude.Just)(b);throw["unhandled case in listToMaybe",[a]];})};
Data.Maybe.catMaybes=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.concatMap)(function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var c=Fay$$_(a).slot1;return Fay$$list([c])}return null})}))(a)})}()})};
Data.Maybe.mapMaybe=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,e=c.cdr;return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Maybe.mapMaybe)(a))(e)});return function(a){if(Fay$$_(a)instanceof Prelude._Nothing)return b;if(Fay$$_(a)instanceof Prelude._Just)return a=Fay$$_(a).slot1,Fay$$_(Fay$$_(Fay$$cons)(a))(b);throw["unhandled case",a];}(Fay$$_(a)(d))})}()}throw["unhandled case in mapMaybe",
[a,b]];})}};Data.Maybe.mapMaybeFB=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){var e;e=Fay$$_(b)(c);if(Fay$$_(e)instanceof Prelude._Nothing)e=d;else if(Fay$$_(e)instanceof Prelude._Just)e=Fay$$_(e).slot1,e=Fay$$_(Fay$$_(a)(e))(d);else throw["unhandled case",e];return e})}}}};
Data.Maybe.whenJust=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var c=Fay$$_(a).slot1;return Fay$$_(b)(c)}if(Fay$$_(a)instanceof Prelude._Nothing)return Fay$$_(Fay$$$_return)(Fay$$unit);throw["unhandled case in whenJust",[a,b]];})}};
Data.Maybe.whenJust$39$=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var c=Fay$$_(a).slot1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(b)(c)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Prelude.Just))}if(Fay$$_(a)instanceof Prelude._Nothing)return Fay$$_(Fay$$$_return)(Prelude.Nothing);throw["unhandled case in whenJust'",[a,b]];})}};
Data.Maybe.onJust=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof Prelude._Just){var c=Fay$$_(b).slot1;return Fay$$_(Prelude.Just)(Fay$$_(a)(c))}if(Fay$$_(b)instanceof Prelude._Nothing)return Prelude.Nothing;throw["unhandled case in onJust",[a,b]];})}};Data.Maybe.joinMaybe=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just&&Fay$$_(Fay$$_(a).slot1)instanceof Prelude._Just){var b=Fay$$_(Fay$$_(a).slot1).slot1;return Fay$$_(Prelude.Just)(b)}return Prelude.Nothing})};
var SharedTypes={_P:function(a,b){this._x=a;this._y=b}};SharedTypes._P.prototype.instance="P";SharedTypes.P=function(a){return function(b){return new Fay$$$(function(){return new SharedTypes._P(a,b)})}};SharedTypes._x=function(a){return new Fay$$$(function(){return Fay$$_(a)._x})};SharedTypes._y=function(a){return new Fay$$$(function(){return Fay$$_(a)._y})};SharedTypes._Line=function(a,b){this.slot1=a;this.slot2=b};SharedTypes._Line.prototype.instance="Line";
SharedTypes.Line=function(a){return function(b){return new Fay$$$(function(){return new SharedTypes._Line(a,b)})}};SharedTypes._Track=function(a,b,c,d){this.trackInner=a;this.trackOuter=b;this.trackStartLine=c;this.trackStartPos=d};SharedTypes._Track.prototype.instance="Track";SharedTypes.Track=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return new SharedTypes._Track(a,b,c,d)})}}}};SharedTypes.trackInner=function(a){return new Fay$$$(function(){return Fay$$_(a).trackInner})};
SharedTypes.trackOuter=function(a){return new Fay$$$(function(){return Fay$$_(a).trackOuter})};SharedTypes.trackStartLine=function(a){return new Fay$$$(function(){return Fay$$_(a).trackStartLine})};SharedTypes.trackStartPos=function(a){return new Fay$$$(function(){return Fay$$_(a).trackStartPos})};SharedTypes._Extremes=function(a,b,c,d){this.eXMin=a;this.eXMax=b;this.eYMin=c;this.eYMax=d};SharedTypes._Extremes.prototype.instance="Extremes";
SharedTypes.Extremes=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return new SharedTypes._Extremes(a,b,c,d)})}}}};SharedTypes.eXMin=function(a){return new Fay$$$(function(){return Fay$$_(a).eXMin})};SharedTypes.eXMax=function(a){return new Fay$$$(function(){return Fay$$_(a).eXMax})};SharedTypes.eYMin=function(a){return new Fay$$$(function(){return Fay$$_(a).eYMin})};SharedTypes.eYMax=function(a){return new Fay$$$(function(){return Fay$$_(a).eYMax})};
SharedTypes._Join=function(a){this.slot1=a};SharedTypes._Join.prototype.instance="Join";SharedTypes.Join=function(a){return new Fay$$$(function(){return new SharedTypes._Join(a)})};SharedTypes._Move=function(a){this.slot1=a};SharedTypes._Move.prototype.instance="Move";SharedTypes.Move=function(a){return new Fay$$$(function(){return new SharedTypes._Move(a)})};SharedTypes._Welcome=function(a){this.slot1=a};SharedTypes._Welcome.prototype.instance="Welcome";SharedTypes.Welcome=function(a){return new Fay$$$(function(){return new SharedTypes._Welcome(a)})};
SharedTypes._Chat=function(a,b){this.slot1=a;this.slot2=b};SharedTypes._Chat.prototype.instance="Chat";SharedTypes.Chat=function(a){return function(b){return new Fay$$$(function(){return new SharedTypes._Chat(a,b)})}};SharedTypes._System=function(a){this.slot1=a};SharedTypes._System.prototype.instance="System";SharedTypes.System=function(a){return new Fay$$$(function(){return new SharedTypes._System(a)})};SharedTypes._Quit=function(a){this.slot1=a};SharedTypes._Quit.prototype.instance="Quit";
SharedTypes.Quit=function(a){return new Fay$$$(function(){return new SharedTypes._Quit(a)})};SharedTypes._Crashed=function(){};SharedTypes._Crashed.prototype.instance="Crashed";SharedTypes.Crashed=new Fay$$$(function(){return new SharedTypes._Crashed});
SharedTypes.almostEqual=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(a))(b)))return!0;if(Fay$$_(Prelude.otherwise))return function(){return new Fay$$$(function(){var c=new Fay$$$(function(){return Fay$$_(Prelude.abs)(Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(a))(b)))(Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(Prelude.abs)(b)))(Fay$$_(Prelude.abs)(a)))?b:a))});return Fay$$_(Fay$$_(Fay$$lte)(c))(1E-4)})}()})}};
SharedTypes.serializeCommand=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._Join){var b=Fay$$_(a).slot1;return Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("join\t"))))(b)}if(Fay$$_(a)instanceof SharedTypes._Quit)return b=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("quit\t"))))(b);if(Fay$$_(a)instanceof SharedTypes._Move)return b=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("move\t"))))(Fay$$_(SharedTypes.tshow)(Fay$$_(SharedTypes._x)(b)))))(Fay$$_(Data.Text.fromString)(Fay$$list("\t")))))(Fay$$_(SharedTypes.tshow)(Fay$$_(SharedTypes._y)(b)));
if(Fay$$_(a)instanceof SharedTypes._Welcome)return b=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("welcome\t"))))(Fay$$_(SharedTypes.tshowI)(b));if(Fay$$_(a)instanceof SharedTypes._Chat){var b=Fay$$_(a).slot1,c=Fay$$_(a).slot2;return Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("chat\t"))))(Fay$$_(SharedTypes.tshowI)(b))))(Fay$$_(Data.Text.fromString)(Fay$$list("\t")))))(c)}if(Fay$$_(a)instanceof
SharedTypes._System)return c=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("system\t"))))(c);if(Fay$$_(a)instanceof SharedTypes._Crashed)return Fay$$_(Data.Text.fromString)(Fay$$list("crashed"));throw["unhandled case in serializeCommand",[a]];})};
SharedTypes.deserializeCommand=function(a){return new Fay$$$(function(){return function(){return Fay$$_(Fay$$_(Prelude.$36$)(function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),2)){var c=Fay$$index(0,Fay$$_(a)),d=Fay$$index(1,Fay$$_(a));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("join")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Join)(d));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("quit")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Quit)(d));
if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("welcome")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Welcome)(Fay$$_(SharedTypes.readI)(d)));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("system")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.System)(d));if(Fay$$_(Prelude.otherwise))return Prelude.Nothing}if(Fay$$listLen(Fay$$_(a),3)){var c=Fay$$index(0,Fay$$_(a)),d=Fay$$index(1,Fay$$_(a)),e=Fay$$index(2,Fay$$_(a));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("move")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Move)(Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(SharedTypes.read)(d)))(Fay$$_(SharedTypes.read)(e))));
if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("chat")))))return Fay$$_(Prelude.Just)(Fay$$_(Fay$$_(SharedTypes.Chat)(Fay$$_(SharedTypes.readI)(d)))(e));if(Fay$$_(Prelude.otherwise))return Prelude.Nothing}if(Fay$$listLen(Fay$$_(a),1)){c=Fay$$index(0,Fay$$_(a));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("crashed")))))return Fay$$_(Prelude.Just)(SharedTypes.Crashed);Fay$$_(Prelude.otherwise)}return Prelude.Nothing})}))(Fay$$_(Fay$$_(SharedTypes.splitOn)(Fay$$_(Data.Text.fromString)(Fay$$list("\t"))))(a))}()})};
SharedTypes.tshow=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],""+Fay$$fayToJs_double(a))})};SharedTypes.tshowI=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],""+Fay$$fayToJs_int(a))})};SharedTypes.splitOn=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Text.splitOn)(Fay$$_(Data.Text.head)(a)))(b)})}};
SharedTypes.read=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(parseInt(Fay$$fayToJs(["user","Text",[]],a),10))})};SharedTypes.readI=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(parseInt(Fay$$fayToJs(["user","Text",[]],a),10))})};
Fay$$objConcat(Fay$$fayToJsHash,{P:function(a,b,c){a={instance:"P"};b=Fay$$fayToJs_double(c._x);void 0!==b&&(a._x=b);c=Fay$$fayToJs_double(c._y);void 0!==c&&(a._y=c);return a},Line:function(a,b,c){a={instance:"Line"};b=Fay$$fayToJs(["user","Point",[]],c.slot1);void 0!==b&&(a.slot1=b);c=Fay$$fayToJs(["user","Point",[]],c.slot2);void 0!==c&&(a.slot2=c);return a},Track:function(a,b,c){a={instance:"Track"};b=Fay$$fayToJs(["list",[["user","Point",[]]]],c.trackInner);void 0!==b&&(a.trackInner=b);b=Fay$$fayToJs(["list",
[["user","Point",[]]]],c.trackOuter);void 0!==b&&(a.trackOuter=b);b=Fay$$fayToJs(["tuple",[["user","Point",[]],["user","Point",[]]]],c.trackStartLine);void 0!==b&&(a.trackStartLine=b);c=Fay$$fayToJs(["list",[["user","Point",[]]]],c.trackStartPos);void 0!==c&&(a.trackStartPos=c);return a},Extremes:function(a,b,c){a={instance:"Extremes"};b=Fay$$fayToJs_double(c.eXMin);void 0!==b&&(a.eXMin=b);b=Fay$$fayToJs_double(c.eXMax);void 0!==b&&(a.eXMax=b);b=Fay$$fayToJs_double(c.eYMin);void 0!==b&&(a.eYMin=b);
c=Fay$$fayToJs_double(c.eYMax);void 0!==c&&(a.eYMax=c);return a},Join:function(a,b,c){a={instance:"Join"};c=Fay$$fayToJs(["user","Text",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Move:function(a,b,c){a={instance:"Move"};c=Fay$$fayToJs(["user","Point",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Welcome:function(a,b,c){a={instance:"Welcome"};c=Fay$$fayToJs_int(c.slot1);void 0!==c&&(a.slot1=c);return a},Chat:function(a,b,c){a={instance:"Chat"};b=Fay$$fayToJs_int(c.slot1);void 0!==b&&(a.slot1=
b);c=Fay$$fayToJs(["user","Text",[]],c.slot2);void 0!==c&&(a.slot2=c);return a},System:function(a,b,c){a={instance:"System"};c=Fay$$fayToJs(["user","Text",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Quit:function(a,b,c){a={instance:"Quit"};c=Fay$$fayToJs(["user","Text",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Crashed:function(a,b,c){return{instance:"Crashed"}}});
Fay$$objConcat(Fay$$jsToFayHash,{P:function(a,b,c){return new SharedTypes._P(Fay$$jsToFay_double(c._x),Fay$$jsToFay_double(c._y))},Line:function(a,b,c){return new SharedTypes._Line(Fay$$jsToFay(["user","Point",[]],c.slot1),Fay$$jsToFay(["user","Point",[]],c.slot2))},Track:function(a,b,c){return new SharedTypes._Track(Fay$$jsToFay(["list",[["user","Point",[]]]],c.trackInner),Fay$$jsToFay(["list",[["user","Point",[]]]],c.trackOuter),Fay$$jsToFay(["tuple",[["user","Point",[]],["user","Point",[]]]],c.trackStartLine),
Fay$$jsToFay(["list",[["user","Point",[]]]],c.trackStartPos))},Extremes:function(a,b,c){return new SharedTypes._Extremes(Fay$$jsToFay_double(c.eXMin),Fay$$jsToFay_double(c.eXMax),Fay$$jsToFay_double(c.eYMin),Fay$$jsToFay_double(c.eYMax))},Join:function(a,b,c){return new SharedTypes._Join(Fay$$jsToFay(["user","Text",[]],c.slot1))},Move:function(a,b,c){return new SharedTypes._Move(Fay$$jsToFay(["user","Point",[]],c.slot1))},Welcome:function(a,b,c){return new SharedTypes._Welcome(Fay$$jsToFay_int(c.slot1))},
Chat:function(a,b,c){return new SharedTypes._Chat(Fay$$jsToFay_int(c.slot1),Fay$$jsToFay(["user","Text",[]],c.slot2))},System:function(a,b,c){return new SharedTypes._System(Fay$$jsToFay(["user","Text",[]],c.slot1))},Quit:function(a,b,c){return new SharedTypes._Quit(Fay$$jsToFay(["user","Text",[]],c.slot1))},Crashed:function(a,b,c){return new SharedTypes._Crashed}});var DotRace={FFI:{}};DotRace.FFI.Raw={};
DotRace.FFI.Raw.readTrackData=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],$("#track").val()))});DotRace.FFI.Raw.parseTrackData=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Track",[]],JSON.parse(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.addWindowEvent=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.addEventListener(Fay$$fayToJs(["user","Text",[]],a),Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],b))))})}};DotRace.FFI.Raw.selectId=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document.getElementById(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.selectClass=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["list",[["user","Element",[]]]],document.getElementsByClassName(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.addEvent=function(a){return function(b){return function(c){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$(Fay$$fayToJs(["user","Element",[]],a)).on(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],c))))})}}};DotRace.FFI.Raw.eventPageX=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Event",[]],a).pageX))})};
DotRace.FFI.Raw.eventPageY=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Event",[]],a).pageY))})};DotRace.FFI.Raw.getBoundingClientRect=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).getBoundingClientRect()))})};
DotRace.FFI.Raw.rectLeft=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).left))})};DotRace.FFI.Raw.rectTop=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).top))})};DotRace.FFI.Raw.getScrollTop=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).scrollTop))})};
DotRace.FFI.Raw.getScrollLeft=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).scrollLeft))})};DotRace.FFI.Raw.hide=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).remove()))})};DotRace.FFI.Raw.getURL=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],document.URL))});
DotRace.FFI.Raw.getWSConnection=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Connection",[]],new WebSocket(document.URL.replace("http","ws"))))});DotRace.FFI.Raw.onMessage=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Connection",[]],a).onmessage=Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],b)))})}};
DotRace.FFI.Raw.getText=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Event",[]],a).data))})};DotRace.FFI.Raw.sendText=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Connection",[]],a).send(Fay$$fayToJs(["user","Text",[]],b))))})}};
DotRace.FFI.Raw.addChatMessage=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chat div").append("<p>"+Fay$$fayToJs(["user","Text",[]],a)+"</p>")))})};DotRace.FFI.Raw.preventDefault=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Event",[]],a).preventDefault()))})};DotRace.FFI.Raw.eventKey=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs(["user","Event",[]],a).keyCode)})};
DotRace.FFI.Raw.getChatMessage=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],$("#chatInput").val()))});DotRace.FFI.Raw.clearChatMessage=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chatInput").val("")))});DotRace.FFI.Raw.getSelectedValue=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],a).options[Fay$$fayToJs(["user","Element",[]],a).selectedIndex].value))})};
DotRace.FFI.Raw.setMax=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).setAttribute("max",Fay$$fayToJs_int(b))))})}};DotRace.FFI.Raw.getValue=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],a).value))})};
DotRace.FFI.Raw.setValue=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).value=Fay$$fayToJs_int(b)))})}};DotRace.FFI.Raw.setTextValue=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).value=Fay$$fayToJs(["user","Text",[]],b)))})}};
DotRace.FFI.Raw.focusElement=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).focus()))})};DotRace.FFI.Raw.showDialog=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#"+Fay$$fayToJs(["user","Text",[]],a)+"").modal()))})};DotRace.FFI.Raw.getPlayerName=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],$("#inputName").val()))});
DotRace.FFI.Raw.getNumPlayers=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(parseInt($("#numPlayers").val(),10)))});DotRace.FFI.Raw.setWinner=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#winner").text(Fay$$fayToJs(["user","Text",[]],a))))})};DotRace.FFI.Raw.displayThisPlayerName=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#thisPlayerName").text(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.displayThisPlayerNum=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#thisPlayerName").addClass("player-"+Fay$$fayToJs_int(a))))})};DotRace.FFI.Raw.displayGameStatus=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#gameStatus").html(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.displayChatMsgRaw=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chat div").append(Fay$$fayToJs(["user","Text",[]],a))))})};DotRace.FFI.Raw.scrollChat=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chat div").stop().animate({scrollTop:$("#chat div")[0].scrollHeight},800)))});
DotRace.FFI.eventLocation=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getBoundingClientRect)(a)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getScrollTop)(a)))(function(d){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getScrollLeft)(a)))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.rectTop)(c)))(function(f){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.rectLeft)(c)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.eventPageX)(b)))(function(h){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.eventPageY)(b)))(function(b){return Fay$$_(Fay$$$_return)(Fay$$list([Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$sub)(h))(c)))(a),Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$sub)(b))(f)))(d)]))})})})})})})})})}};
DotRace.FFI.setMaxLimit=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(DotRace.FFI.Raw.setMax)(a))(b)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getValue)(a)))(function(c){return Fay$$_(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(SharedTypes.readI)(c)))(b)))(Fay$$_(Fay$$_(DotRace.FFI.Raw.setValue)(a))(b))}))})}};DotRace.FFI.showCrashDialog=new Fay$$$(function(){return Fay$$_(DotRace.FFI.Raw.showDialog)("crash-dialog")});
DotRace.FFI.displayPlayerJoin=new Fay$$$(function(){return Fay$$_(DotRace.FFI.displayPlayerAction)("joined")});DotRace.FFI.displayPlayerQuit=new Fay$$$(function(){return Fay$$_(DotRace.FFI.displayPlayerAction)("left")});DotRace.FFI.displayPlayerAction=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(DotRace.FFI.displaySystemMsg)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("<span class='player-"))(Fay$$_(Data.Text.showInt)(b))))("'>")))(c)))("</span> has ")))(a)))("."))})}}};
DotRace.FFI.displaySystemMsg=new Fay$$$(function(){return Fay$$_(Fay$$_(DotRace.FFI.displayChatMsg)(0))("System")});DotRace.FFI.showWinDialog=new Fay$$$(function(){return Fay$$_(DotRace.FFI.Raw.showDialog)("win-dialog")});DotRace.FFI.showLoseDialog=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.setWinner)(a)))(Fay$$_(DotRace.FFI.Raw.showDialog)("lose-dialog"))})};DotRace.FFI.displayWaitingFor=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(DotRace.FFI.Raw.displayGameStatus))(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("Waiting for <span class='player-"))(Fay$$_(Data.Text.showInt)(b))))("'>")))(a)))("</span>\u2026"))})}};
DotRace.FFI.displayChatMsg=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(DotRace.FFI.Raw.displayChatMsgRaw))(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("<p><span class='player-"))(Fay$$_(Data.Text.showInt)(a))))("'>")))(b)))("</span>: ")))(c)))("</p>"))))(DotRace.FFI.Raw.scrollChat)})}}};
DotRace.FFI.addChatMessage=DotRace.FFI.Raw.addChatMessage;DotRace.FFI.addEvent=DotRace.FFI.Raw.addEvent;DotRace.FFI.addWindowEvent=DotRace.FFI.Raw.addWindowEvent;DotRace.FFI.clearChatMessage=DotRace.FFI.Raw.clearChatMessage;DotRace.FFI.displayChatMsgRaw=DotRace.FFI.Raw.displayChatMsgRaw;DotRace.FFI.displayGameStatus=DotRace.FFI.Raw.displayGameStatus;DotRace.FFI.displayThisPlayerName=DotRace.FFI.Raw.displayThisPlayerName;DotRace.FFI.displayThisPlayerNum=DotRace.FFI.Raw.displayThisPlayerNum;
DotRace.FFI.eventKey=DotRace.FFI.Raw.eventKey;DotRace.FFI.eventPageX=DotRace.FFI.Raw.eventPageX;DotRace.FFI.eventPageY=DotRace.FFI.Raw.eventPageY;DotRace.FFI.focusElement=DotRace.FFI.Raw.focusElement;DotRace.FFI.getBoundingClientRect=DotRace.FFI.Raw.getBoundingClientRect;DotRace.FFI.getChatMessage=DotRace.FFI.Raw.getChatMessage;DotRace.FFI.getNumPlayers=DotRace.FFI.Raw.getNumPlayers;DotRace.FFI.getPlayerName=DotRace.FFI.Raw.getPlayerName;DotRace.FFI.getScrollLeft=DotRace.FFI.Raw.getScrollLeft;
DotRace.FFI.getScrollTop=DotRace.FFI.Raw.getScrollTop;DotRace.FFI.getSelectedValue=DotRace.FFI.Raw.getSelectedValue;DotRace.FFI.getText=DotRace.FFI.Raw.getText;DotRace.FFI.getURL=DotRace.FFI.Raw.getURL;DotRace.FFI.getValue=DotRace.FFI.Raw.getValue;DotRace.FFI.getWSConnection=DotRace.FFI.Raw.getWSConnection;DotRace.FFI.hide=DotRace.FFI.Raw.hide;DotRace.FFI.onMessage=DotRace.FFI.Raw.onMessage;DotRace.FFI.parseTrackData=DotRace.FFI.Raw.parseTrackData;DotRace.FFI.preventDefault=DotRace.FFI.Raw.preventDefault;
DotRace.FFI.readTrackData=DotRace.FFI.Raw.readTrackData;DotRace.FFI.rectLeft=DotRace.FFI.Raw.rectLeft;DotRace.FFI.rectTop=DotRace.FFI.Raw.rectTop;DotRace.FFI.scrollChat=DotRace.FFI.Raw.scrollChat;DotRace.FFI.selectClass=DotRace.FFI.Raw.selectClass;DotRace.FFI.selectId=DotRace.FFI.Raw.selectId;DotRace.FFI.sendText=DotRace.FFI.Raw.sendText;DotRace.FFI.setMax=DotRace.FFI.Raw.setMax;DotRace.FFI.setTextValue=DotRace.FFI.Raw.setTextValue;DotRace.FFI.setValue=DotRace.FFI.Raw.setValue;
DotRace.FFI.setWinner=DotRace.FFI.Raw.setWinner;DotRace.FFI.showDialog=DotRace.FFI.Raw.showDialog;var NewGame={setMaxVal:function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getSelectedValue)(a)))(function(a){a=Fay$$_(Fay$$_(SharedTypes.splitOn)(":"))(a);Fay$$listLen(Fay$$_(a),2)?(a=Fay$$index(1,Fay$$_(a)),a=Fay$$_(Fay$$_(DotRace.FFI.setMaxLimit)(b))(Fay$$_(SharedTypes.readI)(a))):a=Fay$$_(Fay$$$_return)(Fay$$unit);return a})})}},initForm:function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("hident2")))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("hident3")))(function(c){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(a))("change")))(function(d){return Fay$$_(Fay$$_(NewGame.setMaxVal)(a))(c)})))(Fay$$_(Fay$$_(NewGame.setMaxVal)(a))(c))})})})}};
NewGame.main=new Fay$$$(function(){return Fay$$_(Fay$$_(DotRace.FFI.Raw.addWindowEvent)("load"))(NewGame.initForm)});Fay$$_(NewGame.main,!0);
