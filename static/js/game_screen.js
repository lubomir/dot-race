var Data={Data:{}},Fay={FFI:{}};Fay.FFI._Nullable=function(a){this.slot1=a};Fay.FFI._Nullable.prototype.instance="Nullable";Fay.FFI.Nullable=function(a){return new Fay$$$(function(){return new Fay.FFI._Nullable(a)})};Fay.FFI._Null=function(){};Fay.FFI._Null.prototype.instance="Null";Fay.FFI.Null=new Fay$$$(function(){return new Fay.FFI._Null});Fay.FFI._Defined=function(a){this.slot1=a};Fay.FFI._Defined.prototype.instance="Defined";Fay.FFI.Defined=function(a){return new Fay$$$(function(){return new Fay.FFI._Defined(a)})};
Fay.FFI._Undefined=function(){};Fay.FFI._Undefined.prototype.instance="Undefined";Fay.FFI.Undefined=new Fay$$$(function(){return new Fay.FFI._Undefined});
Fay$$objConcat(Fay$$fayToJsHash,{Nullable:function(a,b,c){var d={instance:"Nullable"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Null:function(a,b,c){return{instance:"Null"}},Defined:function(a,b,c){var d={instance:"Defined"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Undefined:function(a,b,c){return{instance:"Undefined"}}});
Fay$$objConcat(Fay$$jsToFayHash,{Nullable:function(a,b,c){return new Fay.FFI._Nullable(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Null:function(a,b,c){return new Fay.FFI._Null},Defined:function(a,b,c){return new Fay.FFI._Defined(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Undefined:function(a,b,c){return new Fay.FFI._Undefined}});var Prelude={_Just:function(a){this.slot1=a}};Prelude._Just.prototype.instance="Just";
Prelude.Just=function(a){return new Fay$$$(function(){return new Prelude._Just(a)})};Prelude._Nothing=function(){};Prelude._Nothing.prototype.instance="Nothing";Prelude.Nothing=new Fay$$$(function(){return new Prelude._Nothing});Prelude._Left=function(a){this.slot1=a};Prelude._Left.prototype.instance="Left";Prelude.Left=function(a){return new Fay$$$(function(){return new Prelude._Left(a)})};Prelude._Right=function(a){this.slot1=a};Prelude._Right.prototype.instance="Right";Prelude.Right=function(a){return new Fay$$$(function(){return new Prelude._Right(a)})};
Prelude.maybe=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof Prelude._Nothing)return a;if(Fay$$_(c)instanceof Prelude._Just){var d=Fay$$_(c).slot1;return Fay$$_(b)(d)}throw["unhandled case in maybe",[a,b,c]];})}}};Prelude.$62$$62$$61$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$bind(a)(b))})}};Prelude.$62$$62$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$then(a)(b))})}};
Prelude.$_return=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$return(Fay$$fayToJs(["unknown"],a))))})};Prelude.fail=new Fay$$$(function(){return Prelude.error});Prelude.when=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(a)?Fay$$_(Fay$$_(Fay$$then)(b))(Fay$$_(Fay$$$_return)(Fay$$unit)):Fay$$_(Fay$$$_return)(Fay$$unit)})}};
Prelude.unless=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(a)?Fay$$_(Fay$$$_return)(Fay$$unit):Fay$$_(Fay$$_(Fay$$then)(b))(Fay$$_(Fay$$$_return)(Fay$$unit))})}};Prelude.forM=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.sequence))(Fay$$_(Fay$$_(Prelude.map)(b))(a))})}};
Prelude.forM_=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(a);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(b)(d)))(Fay$$_(Fay$$_(Prelude.forM_)(c))(b))}if(null===Fay$$_(a))return Fay$$_(Fay$$$_return)(Fay$$unit);throw["unhandled case in forM_",[a,b]];})}};Prelude.mapM=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.sequence))(Fay$$_(Fay$$_(Prelude.map)(a))(b))})}};
Prelude.mapM_=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.mapM_)(a))(c))}if(null===Fay$$_(b))return Fay$$_(Fay$$$_return)(Fay$$unit);throw["unhandled case in mapM_",[a,b]];})}};Prelude.$61$$60$$60$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(b))(a)})}};Prelude.$_void=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(a))(Fay$$_(Fay$$$_return)(Fay$$unit))})};
Prelude.$62$$61$$62$=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(a)(c)))(b)})}}};Prelude.$60$$61$$60$=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(b)(c)))(a)})}}};Prelude.sequence=function(a){return new Fay$$$(function(){return function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.foldr)(function(a){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(a))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(c))(function(b){return Fay$$_(Fay$$$_return)(Fay$$_(Fay$$_(Fay$$cons)(a))(b))})})})}}))(Fay$$_(Fay$$$_return)(null)))(a)}()})};
Prelude.sequence_=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Fay$$$_return)(Fay$$unit);var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$then)(c))(Fay$$_(Prelude.sequence_)(b))}throw["unhandled case in sequence_",[a]];})};Prelude._GT=function(){};Prelude._GT.prototype.instance="GT";Prelude.GT=new Fay$$$(function(){return new Prelude._GT});Prelude._LT=function(){};Prelude._LT.prototype.instance="LT";Prelude.LT=new Fay$$$(function(){return new Prelude._LT});
Prelude._EQ=function(){};Prelude._EQ.prototype.instance="EQ";Prelude.EQ=new Fay$$$(function(){return new Prelude._EQ});Prelude.compare=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(b))?Prelude.GT:Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(b))?Prelude.LT:Prelude.EQ})}};Prelude.succ=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$add)(a))(1)})};Prelude.pred=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$sub)(a))(1)})};
Prelude.enumFrom=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Prelude.enumFrom)(Fay$$_(Fay$$_(Fay$$add)(a))(1)))})};Prelude.enumFromTo=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(b))?null:Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Fay$$_(Prelude.enumFromTo)(Fay$$_(Fay$$_(Fay$$add)(a))(1)))(b))})}};Prelude.enumFromBy=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Fay$$_(Prelude.enumFromBy)(Fay$$_(Fay$$_(Fay$$add)(a))(b)))(b))})}};
Prelude.enumFromThen=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.enumFromBy)(a))(Fay$$_(Fay$$_(Fay$$sub)(b))(a))})}};
Prelude.enumFromByTo=function(a){return function(b){return function(c){return new Fay$$$(function(){return function(){var d=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(c))?null:Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(d)(Fay$$_(Fay$$_(Fay$$add)(a))(b)))})},e=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(c))?null:Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(e)(Fay$$_(Fay$$_(Fay$$add)(a))(b)))})};return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(b))(0))?
Fay$$_(d)(a):Fay$$_(e)(a)}()})}}};Prelude.enumFromThenTo=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.enumFromByTo)(a))(Fay$$_(Fay$$_(Fay$$sub)(b))(a)))(c)})}}};Prelude.fromIntegral=function(a){return new Fay$$$(function(){return a})};Prelude.fromInteger=function(a){return new Fay$$$(function(){return a})};Prelude.not=function(a){return new Fay$$$(function(){return Fay$$_(a)?!1:!0})};Prelude.otherwise=!0;
Prelude.show=function(a){return new Fay$$$(function(){return Fay$$jsToFay_string(JSON.stringify(Fay$$fayToJs(["automatic"],a)))})};Prelude.error=function(a){return new Fay$$$(function(){throw Fay$$fayToJs_string(a);})};Prelude.$_undefined=new Fay$$$(function(){return Fay$$_(Prelude.error)(Fay$$list("Prelude.undefined"))});
Prelude.either=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof Prelude._Left){var d=Fay$$_(c).slot1;return Fay$$_(a)(d)}if(Fay$$_(c)instanceof Prelude._Right)return d=Fay$$_(c).slot1,Fay$$_(b)(d);throw["unhandled case in either",[a,b,c]];})}}};Prelude.until=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(a)(c))?c:Fay$$_(Fay$$_(Fay$$_(Prelude.until)(a))(b))(Fay$$_(b)(c))})}}};
Prelude.$36$$33$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$seq)(b))(Fay$$_(a)(b))})}};Prelude.$_const=function(a){return function(b){return new Fay$$$(function(){return a})}};Prelude.id=function(a){return new Fay$$$(function(){return a})};Prelude.$46$=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(a)(Fay$$_(b)(c))})}}};Prelude.$36$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(a)(b)})}};
Prelude.flip=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(a)(c))(b)})}}};Prelude.curry=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(a)(Fay$$list([b,c]))})}}};Prelude.uncurry=function(a){return function(b){return new Fay$$$(function(){var c;if(Fay$$listLen(Fay$$_(b),2)){c=Fay$$index(0,Fay$$_(b));var d=Fay$$index(1,Fay$$_(b));c=Fay$$_(Fay$$_(a)(c))(d)}else throw["unhandled case",b];return c})}};
Prelude.snd=function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),2))return Fay$$index(1,Fay$$_(a));throw["unhandled case in snd",[a]];})};Prelude.fst=function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),2))return Fay$$index(0,Fay$$_(a));throw["unhandled case in fst",[a]];})};
Prelude.div=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(d))(0)))(Fay$$_(Fay$$_(Fay$$lt)(c))(0))))return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.quot)(Fay$$_(Fay$$_(Fay$$sub)(d))(1)))(c)))(1);if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(d))(0)))(Fay$$_(Fay$$_(Fay$$gt)(c))(0))))return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.quot)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c)))(1);c=b;d=a;return Fay$$_(Fay$$_(Prelude.quot)(d))(c)})}};
Prelude.mod=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(d))(0)))(Fay$$_(Fay$$_(Fay$$lt)(c))(0))))return Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.rem)(Fay$$_(Fay$$_(Fay$$sub)(d))(1)))(c)))(c)))(1);if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(d))(0)))(Fay$$_(Fay$$_(Fay$$gt)(c))(0))))return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.rem)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c)))(c)))(1);
c=b;d=a;return Fay$$_(Fay$$_(Prelude.rem)(d))(c)})}};
Prelude.divMod=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(d))(0)))(Fay$$_(Fay$$_(Fay$$lt)(c))(0))))return function(a){if(Fay$$listLen(Fay$$_(a),2)){var b=Fay$$index(0,Fay$$_(a));a=Fay$$index(1,Fay$$_(a));return Fay$$list([Fay$$_(Fay$$_(Fay$$sub)(b))(1),Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$add)(a))(c)))(1)])}throw["unhandled case",a];}(Fay$$_(Fay$$_(Prelude.quotRem)(Fay$$_(Fay$$_(Fay$$sub)(d))(1)))(c));if(Fay$$_(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(d))(0)))(Fay$$_(Fay$$_(Fay$$gt)(c))(1))))return function(a){if(Fay$$listLen(Fay$$_(a),
2)){var b=Fay$$index(0,Fay$$_(a));a=Fay$$index(1,Fay$$_(a));return Fay$$list([Fay$$_(Fay$$_(Fay$$sub)(b))(1),Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$add)(a))(c)))(1)])}throw["unhandled case",a];}(Fay$$_(Fay$$_(Prelude.quotRem)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c));c=b;d=a;return Fay$$_(Fay$$_(Prelude.quotRem)(d))(c)})}};
Prelude.min=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.min(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(Fay$$fayToJs(["unknown"],b))))})}};Prelude.max=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.max(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(Fay$$fayToJs(["unknown"],b))))})}};Prelude.recip=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(1))(a)})};Prelude.negate=function(a){return new Fay$$$(function(){return-Fay$$_(a)})};
Prelude.abs=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?Fay$$_(Prelude.negate)(a):a})};Prelude.signum=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(0))?1:Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(a))(0))?0:-1})};Prelude.pi=new Fay$$$(function(){return Fay$$jsToFay_double(Math.PI)});Prelude.exp=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.exp(Fay$$fayToJs_double(a)))})};Prelude.sqrt=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.sqrt(Fay$$fayToJs_double(a)))})};
Prelude.log=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.log(Fay$$fayToJs_double(a)))})};Prelude.$42$$42$=new Fay$$$(function(){return Prelude.unsafePow});Prelude.$94$$94$=new Fay$$$(function(){return Prelude.unsafePow});Prelude.unsafePow=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["unknown"],Math.pow(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(Fay$$fayToJs(["unknown"],b))))})}};
Prelude.$94$=function(a){return function(b){return new Fay$$$(function(){var c=b,d=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(c))(0)))return Fay$$_(Prelude.error)(Fay$$list("(^): negative exponent"));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(0)))return 1;if(Fay$$_(Fay$$_(Prelude.even)(c)))return function(){return new Fay$$$(function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$94$)(d))(Fay$$_(Fay$$_(Prelude.quot)(c))(2))});return Fay$$_(Fay$$_(Fay$$mult)(a))(a)})}();c=b;d=a;return Fay$$_(Fay$$_(Fay$$mult)(d))(Fay$$_(Fay$$_(Prelude.$94$)(d))(Fay$$_(Fay$$_(Fay$$sub)(c))(1)))})}};
Prelude.logBase=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.log)(b)))(Fay$$_(Prelude.log)(a))})}};Prelude.sin=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.sin(Fay$$fayToJs_double(a)))})};Prelude.tan=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.tan(Fay$$fayToJs_double(a)))})};Prelude.cos=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.cos(Fay$$fayToJs_double(a)))})};
Prelude.asin=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.asin(Fay$$fayToJs_double(a)))})};Prelude.atan=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.atan(Fay$$fayToJs_double(a)))})};Prelude.acos=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(Math.acos(Fay$$fayToJs_double(a)))})};Prelude.sinh=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Prelude.exp)(a)))(Fay$$_(Prelude.exp)(-Fay$$_(a)))))(2)})};
Prelude.tanh=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Prelude.exp)(a)}),c=new Fay$$$(function(){return Fay$$_(Prelude.exp)(-Fay$$_(a))});return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(b))(c)))(Fay$$_(Fay$$_(Fay$$add)(b))(c))})}()})};Prelude.cosh=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Prelude.exp)(a)))(Fay$$_(Prelude.exp)(-Fay$$_(a)))))(2)})};
Prelude.asinh=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$add)(a))(Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.$42$$42$)(a))(2)))(1))))})};Prelude.atanh=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$add)(1))(a)))(Fay$$_(Fay$$_(Fay$$sub)(1))(a)))))(2)})};Prelude.acosh=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.log)(Fay$$_(Fay$$_(Fay$$add)(a))(Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Prelude.$42$$42$)(a))(2)))(1))))})};
Prelude.properFraction=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Prelude.truncate)(a)});return Fay$$list([b,Fay$$_(Fay$$_(Fay$$sub)(a))(Fay$$_(Prelude.fromIntegral)(b))])})}()})};Prelude.truncate=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?Fay$$_(Prelude.ceiling)(a):Fay$$_(Prelude.floor)(a)})};Prelude.round=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.round(Fay$$fayToJs_double(a)))})};
Prelude.ceiling=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.ceil(Fay$$fayToJs_double(a)))})};Prelude.floor=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Math.floor(Fay$$fayToJs_double(a)))})};Prelude.subtract=new Fay$$$(function(){return Fay$$_(Prelude.flip)(Fay$$sub)});Prelude.even=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Fay$$_(Prelude.rem)(a))(2)))(0)})};Prelude.odd=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.not)(Fay$$_(Prelude.even)(a))})};
Prelude.gcd=function(a){return function(b){return new Fay$$$(function(){return function(){var c=function(a){return function(b){return new Fay$$$(function(){if(0===Fay$$_(b)){var f=a;return f}f=a;return Fay$$_(Fay$$_(c)(b))(Fay$$_(Fay$$_(Prelude.rem)(f))(b))})}};return Fay$$_(Fay$$_(c)(Fay$$_(Prelude.abs)(a)))(Fay$$_(Prelude.abs)(b))}()})}};
Prelude.quot=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(b))(0))?Fay$$_(Prelude.error)(Fay$$list("Division by zero")):Fay$$_(Fay$$_(Prelude.quot$39$)(a))(b)})}};Prelude.quot$39$=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_int(~~(Fay$$fayToJs_int(a)/Fay$$fayToJs_int(b)))})}};Prelude.quotRem=function(a){return function(b){return new Fay$$$(function(){return Fay$$list([Fay$$_(Fay$$_(Prelude.quot)(a))(b),Fay$$_(Fay$$_(Prelude.rem)(a))(b)])})}};
Prelude.rem=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(b))(0))?Fay$$_(Prelude.error)(Fay$$list("Division by zero")):Fay$$_(Fay$$_(Prelude.rem$39$)(a))(b)})}};Prelude.rem$39$=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs_int(a)%Fay$$fayToJs_int(b))})}};Prelude.lcm=function(a){return function(b){return new Fay$$$(function(){return 0===Fay$$_(b)||0===Fay$$_(a)?0:Fay$$_(Prelude.abs)(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Prelude.quot)(a))(Fay$$_(Fay$$_(Prelude.gcd)(a))(b))))(b))})}};
Prelude.find=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Prelude.Just)(d):Fay$$_(Fay$$_(Prelude.find)(a))(c)}if(null===Fay$$_(b))return Prelude.Nothing;throw["unhandled case in find",[a,b]];})}};
Prelude.filter=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.filter)(a))(c)):Fay$$_(Fay$$_(Prelude.filter)(a))(c)}if(null===Fay$$_(b))return null;throw["unhandled case in filter",[a,b]];})}};Prelude.$_null=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?!0:!1})};
Prelude.map=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.map)(a))(c))}throw["unhandled case in map",[a,b]];})}};Prelude.nub=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.nub$39$)(a))(null)})};
Prelude.nub$39$=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(a))return null;var c=Fay$$_(a);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.elem)(d))(b))?Fay$$_(Fay$$_(Prelude.nub$39$)(c))(b):Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.nub$39$)(c))(Fay$$_(Fay$$_(Fay$$cons)(d))(b)))}throw["unhandled case in nub'",[a,b]];})}};
Prelude.elem=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(Fay$$_(Fay$$eq)(a))(d)))(Fay$$_(Fay$$_(Prelude.elem)(a))(c))}if(null===Fay$$_(b))return!1;throw["unhandled case in elem",[a,b]];})}};Prelude.notElem=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Prelude.not)(Fay$$_(Fay$$_(Prelude.elem)(a))(b))})}};Prelude.sort=new Fay$$$(function(){return Fay$$_(Prelude.sortBy)(Prelude.compare)});
Prelude.sortBy=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Fay$$_(Prelude.insertBy)(a)))(null)})};
Prelude.insertBy=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return Fay$$list([d])}d=b;if(null===Fay$$_(c))d=Fay$$list([d]);else{var e=Fay$$_(c);if(e instanceof Fay$$Cons)var f=e.car,e=e.cdr,g=Fay$$_(Fay$$_(a)(d))(f),d=Fay$$_(g)instanceof Prelude._GT?Fay$$_(Fay$$_(Fay$$cons)(f))(Fay$$_(Fay$$_(Fay$$_(Prelude.insertBy)(a))(d))(e)):Fay$$_(Fay$$_(Fay$$cons)(d))(c);else throw["unhandled case",c];}return d})}}};
Prelude.conc=function(a){return function(b){return new Fay$$$(function(){var c=b,d=Fay$$_(a);if(d instanceof Fay$$Cons){var e=d.car,d=d.cdr;return Fay$$_(Fay$$_(Fay$$cons)(e))(Fay$$_(Fay$$_(Prelude.conc)(d))(c))}c=b;if(null===Fay$$_(a))return c;throw["unhandled case in conc",[a,b]];})}};Prelude.concat=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Prelude.conc))(null)});Prelude.concatMap=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.foldr)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.$43$$43$))(a)))(null)})};
Prelude.foldr=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return d}d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=b;return Fay$$_(Fay$$_(a)(e))(Fay$$_(Fay$$_(Fay$$_(Prelude.foldr)(a))(d))(f))}throw["unhandled case in foldr",[a,b,c]];})}}};
Prelude.foldr1=function(a){return function(b){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(b),1)){var c=Fay$$index(0,Fay$$_(b));return c}var d=Fay$$_(b);if(d instanceof Fay$$Cons)return c=d.car,d=d.cdr,Fay$$_(Fay$$_(a)(c))(Fay$$_(Fay$$_(Prelude.foldr1)(a))(d));if(null===Fay$$_(b))return Fay$$_(Prelude.error)(Fay$$list("foldr1: empty list"));throw["unhandled case in foldr1",[a,b]];})}};
Prelude.foldl=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return d}d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=b;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(a))(Fay$$_(Fay$$_(a)(d))(e)))(f)}throw["unhandled case in foldl",[a,b,c]];})}}};
Prelude.foldl1=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(a))(d))(c)}if(null===Fay$$_(b))return Fay$$_(Prelude.error)(Fay$$list("foldl1: empty list"));throw["unhandled case in foldl1",[a,b]];})}};Prelude.$43$$43$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.conc)(a))(b)})}};
Prelude.$33$$33$=function(a){return function(b){return new Fay$$$(function(){return function(){var c=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("(!!): index too large"));if(0===Fay$$_(b)){var f=Fay$$_(a);if(f instanceof Fay$$Cons)return f.car}f=Fay$$_(a);if(f instanceof Fay$$Cons)return f=f.cdr,Fay$$_(Fay$$_(c)(f))(Fay$$_(Fay$$_(Fay$$sub)(b))(1));throw["unhandled case in go",[a,b]];})}};return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(b))(0))?
Fay$$_(Prelude.error)(Fay$$list("(!!): negative index")):Fay$$_(Fay$$_(c)(a))(b)}()})}};Prelude.head=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("head: empty list"));var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b.car;throw["unhandled case in head",[a]];})};
Prelude.tail=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("tail: empty list"));var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b.cdr;throw["unhandled case in tail",[a]];})};
Prelude.init=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("init: empty list"));if(Fay$$listLen(Fay$$_(a),1))return Fay$$index(0,Fay$$_(a)),null;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$cons)(c))(Fay$$_(Prelude.init)(b))}throw["unhandled case in init",[a]];})};
Prelude.last=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("last: empty list"));if(Fay$$listLen(Fay$$_(a),1))return Fay$$index(0,Fay$$_(a));var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b=b.cdr,Fay$$_(Prelude.last)(b);throw["unhandled case in last",[a]];})};Prelude.iterate=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(b))(Fay$$_(Fay$$_(Prelude.iterate)(a))(Fay$$_(a)(b)))})}};Prelude.repeat=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Prelude.repeat)(a))})};
Prelude.replicate=function(a){return function(b){return new Fay$$$(function(){return 0===Fay$$_(a)?null:Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?null:Fay$$_(Fay$$_(Fay$$cons)(b))(Fay$$_(Fay$$_(Prelude.replicate)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(b))})}};Prelude.cycle=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?Fay$$_(Prelude.error)(Fay$$list("cycle: empty list")):function(){var b=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$43$$43$)(a))(b)});return b}()})};
Prelude.take=function(a){return function(b){return new Fay$$$(function(){if(0===Fay$$_(a)||null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?null:Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.take)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(c))}throw["unhandled case in take",[a,b]];})}};
Prelude.drop=function(a){return function(b){return new Fay$$$(function(){var c=b;if(0===Fay$$_(a))return c;if(null===Fay$$_(b))return null;c=Fay$$_(b);if(c instanceof Fay$$Cons)return c=c.cdr,Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0))?b:Fay$$_(Fay$$_(Prelude.drop)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(c);throw["unhandled case in drop",[a,b]];})}};
Prelude.splitAt=function(a){return function(b){return new Fay$$$(function(){var c=b;if(0===Fay$$_(a))return Fay$$list([null,c]);if(null===Fay$$_(b))return Fay$$list([null,null]);c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;if(Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(0)))d=Fay$$list([null,Fay$$_(Fay$$_(Fay$$cons)(d))(c)]);else{var e=Fay$$_(Fay$$_(Prelude.splitAt)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(c);if(Fay$$listLen(Fay$$_(e),2))c=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),d=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(d))(c),
e]);else throw["unhandled case",e];}return d}throw["unhandled case in splitAt",[a,b]];})}};Prelude.takeWhile=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.takeWhile)(a))(c)):null}throw["unhandled case in takeWhile",[a,b]];})}};
Prelude.dropWhile=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(a)(d))?Fay$$_(Fay$$_(Prelude.dropWhile)(a))(c):Fay$$_(Fay$$_(Fay$$cons)(d))(c)}throw["unhandled case in dropWhile",[a,b]];})}};
Prelude.span=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return Fay$$list([null,null]);var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;if(Fay$$_(Fay$$_(a)(d))){var e=Fay$$_(Fay$$_(Prelude.span)(a))(c);if(Fay$$listLen(Fay$$_(e),2))c=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),d=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(d))(c),e]);else throw["unhandled case",e];}else d=Fay$$list([null,Fay$$_(Fay$$_(Fay$$cons)(d))(c)]);return d}throw["unhandled case in span",
[a,b]];})}};Prelude.$_break=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.span)(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.not))(a))})};Prelude.zipWith=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=Fay$$_(b);if(d instanceof Fay$$Cons){var g=d.car,d=d.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(a)(g))(e)))(Fay$$_(Fay$$_(Fay$$_(Prelude.zipWith)(a))(d))(f))}}return null})}}};
Prelude.zipWith3=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){var e=Fay$$_(d);if(e instanceof Fay$$Cons){var f=e.car,g=e.cdr,e=Fay$$_(c);if(e instanceof Fay$$Cons){var h=e.car,k=e.cdr,e=Fay$$_(b);if(e instanceof Fay$$Cons){var l=e.car,e=e.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(Fay$$_(a)(l))(h))(f)))(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Prelude.zipWith3)(a))(e))(k))(g))}}}return null})}}}};
Prelude.zip=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,e=c.cdr,c=Fay$$_(a);if(c instanceof Fay$$Cons){var f=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$list([f,d])))(Fay$$_(Fay$$_(Prelude.zip)(c))(e))}}return null})}};
Prelude.zip3=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=Fay$$_(b);if(d instanceof Fay$$Cons){var g=d.car,h=d.cdr,d=Fay$$_(a);if(d instanceof Fay$$Cons){var k=d.car,d=d.cdr;return Fay$$_(Fay$$_(Fay$$cons)(Fay$$list([k,g,e])))(Fay$$_(Fay$$_(Fay$$_(Prelude.zip3)(d))(h))(f))}}}return null})}}};
Prelude.unzip=function(a){return new Fay$$$(function(){var b=Fay$$_(a);if(b instanceof Fay$$Cons&&Fay$$listLen(Fay$$_(b.car),2)){var c=Fay$$index(0,Fay$$_(b.car)),d=Fay$$index(1,Fay$$_(b.car)),b=b.cdr;var e=Fay$$_(Prelude.unzip)(b);if(Fay$$listLen(Fay$$_(e),2))b=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),c=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(c))(b),Fay$$_(Fay$$_(Fay$$cons)(d))(e)]);else throw["unhandled case",e];return c}if(null===Fay$$_(a))return Fay$$list([null,null]);throw["unhandled case in unzip",
[a]];})};
Prelude.unzip3=function(a){return new Fay$$$(function(){var b=Fay$$_(a);if(b instanceof Fay$$Cons&&Fay$$listLen(Fay$$_(b.car),3)){var c=Fay$$index(0,Fay$$_(b.car)),d=Fay$$index(1,Fay$$_(b.car)),e=Fay$$index(2,Fay$$_(b.car)),b=b.cdr;var f=Fay$$_(Prelude.unzip3)(b);if(Fay$$listLen(Fay$$_(f),3))var b=Fay$$index(0,Fay$$_(f)),g=Fay$$index(1,Fay$$_(f)),f=Fay$$index(2,Fay$$_(f)),c=Fay$$list([Fay$$_(Fay$$_(Fay$$cons)(c))(b),Fay$$_(Fay$$_(Fay$$cons)(d))(g),Fay$$_(Fay$$_(Fay$$cons)(e))(f)]);else throw["unhandled case",f];
return c}if(null===Fay$$_(a))return Fay$$list([null,null,null]);throw["unhandled case in unzip3",[a]];})};
Prelude.lines=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?null:function(){return function(a){if(Fay$$listLen(Fay$$_(a),2)){var c=Fay$$index(0,Fay$$_(a));if(null===Fay$$_(Fay$$index(1,Fay$$_(a))))return Fay$$list([c])}if(Fay$$listLen(Fay$$_(a),2)){var c=Fay$$index(0,Fay$$_(a)),d=Fay$$_(Fay$$index(1,Fay$$_(a)));if(d instanceof Fay$$Cons)return a=d.cdr,Fay$$_(Fay$$_(Fay$$cons)(c))(Fay$$_(Prelude.lines)(a))}throw["unhandled case",a];}(Fay$$_(Fay$$_(Prelude.$_break)(function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(Fay$$_(Fay$$eq)(a))("\r")))(Fay$$_(Fay$$_(Fay$$eq)(a))("\n"))})}))(a))}()})};
Prelude.unlines=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return null;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Prelude.$43$$43$)(c))(Fay$$_(Fay$$_(Fay$$cons)("\n"))(Fay$$_(Prelude.unlines)(b)))}throw["unhandled case in unlines",[a]];})};
Prelude.words=function(a){return new Fay$$$(function(){return function(){var b=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.elem)(a))(Fay$$list(" \t\r\n\f\x0B"))})};return Fay$$_(function(a){return new Fay$$$(function(){var d;if(null===Fay$$_(a))d=null;else{var e=Fay$$_(Fay$$_(Prelude.$_break)(b))(a);if(Fay$$listLen(Fay$$_(e),2))d=Fay$$index(0,Fay$$_(e)),e=Fay$$index(1,Fay$$_(e)),d=Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Prelude.words)(e));else throw["unhandled case",e];}return d})})(Fay$$_(Fay$$_(Prelude.dropWhile)(b))(a))}()})};
Prelude.unwords=new Fay$$$(function(){return Fay$$_(Prelude.intercalate)(Fay$$list(" "))});Prelude.and=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return!0;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$and)(c))(Fay$$_(Prelude.and)(b))}throw["unhandled case in and",[a]];})};
Prelude.or=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return!1;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Fay$$or)(c))(Fay$$_(Prelude.or)(b))}throw["unhandled case in or",[a]];})};
Prelude.any=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return!1;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$or)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.any)(a))(c))}throw["unhandled case in any",[a,b]];})}};
Prelude.all=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return!0;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(a)(d)))(Fay$$_(Fay$$_(Prelude.all)(a))(c))}throw["unhandled case in all",[a,b]];})}};
Prelude.intersperse=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.prependToAll)(a))(c))}throw["unhandled case in intersperse",[a,b]];})}};
Prelude.prependToAll=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$cons)(a))(Fay$$_(Fay$$_(Fay$$cons)(d))(Fay$$_(Fay$$_(Prelude.prependToAll)(a))(c)))}throw["unhandled case in prependToAll",[a,b]];})}};Prelude.intercalate=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Prelude.concat)(Fay$$_(Fay$$_(Prelude.intersperse)(a))(b))})}};
Prelude.maximum=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?Fay$$_(Prelude.error)(Fay$$list("maximum: empty list")):Fay$$_(Fay$$_(Prelude.foldl1)(Prelude.max))(a)})};Prelude.minimum=function(a){return new Fay$$$(function(){return null===Fay$$_(a)?Fay$$_(Prelude.error)(Fay$$list("minimum: empty list")):Fay$$_(Fay$$_(Prelude.foldl1)(Prelude.min))(a)})};Prelude.product=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(Fay$$mult))(1))(a)})};
Prelude.sum=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Prelude.foldl)(Fay$$add))(0))(a)})};Prelude.scanl=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(Fay$$_(Fay$$cons)(b)),e;if(null===Fay$$_(c))e=null;else{var f=Fay$$_(c);if(f instanceof Fay$$Cons)e=f.car,f=f.cdr,e=Fay$$_(Fay$$_(Fay$$_(Prelude.scanl)(a))(Fay$$_(Fay$$_(a)(b))(e)))(f);else throw["unhandled case",c];}return d(e)})}}};
Prelude.scanl1=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Prelude.scanl)(a))(d))(c)}throw["unhandled case in scanl1",[a,b]];})}};
Prelude.scanr=function(a){return function(b){return function(c){return new Fay$$$(function(){if(null===Fay$$_(c)){var d=b;return Fay$$list([d])}d=Fay$$_(c);if(d instanceof Fay$$Cons){var e=d.car,f=d.cdr,d=b;d=Fay$$_(Fay$$_(Fay$$_(Prelude.scanr)(a))(d))(f);f=Fay$$_(d);f instanceof Fay$$Cons?(d=f.car,f=f.cdr,e=Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(a)(e))(d)))(Fay$$_(Fay$$_(Fay$$cons)(d))(f))):e=Prelude.$_undefined;return e}throw["unhandled case in scanr",[a,b,c]];})}}};
Prelude.scanr1=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;if(Fay$$listLen(Fay$$_(b),1)){var c=Fay$$index(0,Fay$$_(b));return Fay$$list([c])}var d=Fay$$_(b);if(d instanceof Fay$$Cons){c=d.car;d=d.cdr;var d=Fay$$_(Fay$$_(Prelude.scanr1)(a))(d),e=Fay$$_(d);e instanceof Fay$$Cons?(d=e.car,e=e.cdr,c=Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(a)(c))(d)))(Fay$$_(Fay$$_(Fay$$cons)(d))(e))):c=Prelude.$_undefined;return c}throw["unhandled case in scanr1",[a,b]];
})}};Prelude.lookup=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return Prelude.Nothing;var c=Fay$$_(b);if(c instanceof Fay$$Cons&&Fay$$listLen(Fay$$_(c.car),2)){var d=Fay$$index(0,Fay$$_(c.car)),e=Fay$$index(1,Fay$$_(c.car)),c=c.cdr;return Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(a))(d))?Fay$$_(Prelude.Just)(e):Fay$$_(Fay$$_(Prelude.lookup)(a))(c)}throw["unhandled case in lookup",[a,b]];})}};Prelude.length=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.length$39$)(0))(a)})};
Prelude.length$39$=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(b);if(c instanceof Fay$$Cons){var c=c.cdr,d=a;return Fay$$_(Fay$$_(Prelude.length$39$)(Fay$$_(Fay$$_(Fay$$add)(d))(1)))(c)}return d=a})}};
Prelude.reverse=function(a){return new Fay$$$(function(){var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car,b=b.cdr;return Fay$$_(Fay$$_(Prelude.$43$$43$)(Fay$$_(Prelude.reverse)(b)))(Fay$$list([c]))}if(null===Fay$$_(a))return null;throw["unhandled case in reverse",[a]];})};Prelude.print=function(a){return new Fay$$$(function(){var b=Fay$$Monad,c=Fay$$jsToFay,d=Fay$$fayToJs(["automatic"],a);console&&console.log&&console.log(d);return new b(c(["unknown"],void 0))})};
Prelude.putStrLn=function(a){return new Fay$$$(function(){var b=Fay$$Monad,c=Fay$$jsToFay,d=Fay$$fayToJs_string(a);console&&console.log&&console.log(d);return new b(c(["unknown"],void 0))})};Prelude.ifThenElse=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(a)?b:c})}}};
Fay$$objConcat(Fay$$fayToJsHash,{Just:function(a,b,c){var d={instance:"Just"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Nothing:function(a,b,c){return{instance:"Nothing"}},Left:function(a,b,c){var d={instance:"Left"};a=Fay$$fayToJs(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},Right:function(a,b,c){var d={instance:"Right"};a=Fay$$fayToJs(b&&b[1]?b[1]:"automatic"===a[0]?
["automatic"]:["unknown"],c.slot1);void 0!==a&&(d.slot1=a);return d},GT:function(a,b,c){return{instance:"GT"}},LT:function(a,b,c){return{instance:"LT"}},EQ:function(a,b,c){return{instance:"EQ"}}});
Fay$$objConcat(Fay$$jsToFayHash,{Just:function(a,b,c){return new Prelude._Just(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Nothing:function(a,b,c){return new Prelude._Nothing},Left:function(a,b,c){return new Prelude._Left(Fay$$jsToFay(b&&b[0]?b[0]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},Right:function(a,b,c){return new Prelude._Right(Fay$$jsToFay(b&&b[1]?b[1]:"automatic"===a[0]?["automatic"]:["unknown"],c.slot1))},GT:function(a,b,c){return new Prelude._GT},
LT:function(a,b,c){return new Prelude._LT},EQ:function(a,b,c){return new Prelude._EQ}});var FFI={};Data.Nullable={};Data.Nullable.fromNullable=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Fay.FFI._Nullable){var b=Fay$$_(a).slot1;return Fay$$_(Prelude.Just)(b)}if(Fay$$_(a)instanceof Fay.FFI._Null)return Prelude.Nothing;throw["unhandled case in fromNullable",[a]];})};
Data.Nullable.toNullable=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var b=Fay$$_(a).slot1;return Fay$$_(Fay.FFI.Nullable)(b)}if(Fay$$_(a)instanceof Prelude._Nothing)return Fay.FFI.Null;throw["unhandled case in toNullable",[a]];})};Data.Text={};Data.Text.intercalate=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],b).join(Fay$$fayToJs(["user","Text",[]],a)))})}};
Data.Text.fromString=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_string(a))})};Data.Text.snoc=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a)+Fay$$fayToJs(["user","Char",[]],b))})}};Data.Text.cons=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Char",[]],a)+Fay$$fayToJs(["user","Text",[]],b))})}};
Data.Text.pack=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_string(a))})};Data.Text.unpack=function(a){return new Fay$$$(function(){return Fay$$jsToFay_string(Fay$$fayToJs(["user","Text",[]],a))})};Data.Text.append=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a)+Fay$$fayToJs(["user","Text",[]],b))})}};
Data.Text.$60$$62$=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a)+Fay$$fayToJs(["user","Text",[]],b))})}};Data.Text.length=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs(["user","Text",[]],a).length)})};Data.Text.$_null=function(a){return new Fay$$$(function(){return Fay$$jsToFay_bool(0==Fay$$fayToJs(["user","Text",[]],a).length)})};
Data.Text.take=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],b).substring(0,Fay$$fayToJs_int(a)))})}};Data.Text.drop=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],b).substring(Fay$$fayToJs_int(a)))})}};Data.Text.empty=new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],"")});
Data.Text.lines=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Text",[]]]],Fay$$fayToJs(["user","Text",[]],a).split("\n"))})};Data.Text.unlines=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],a).join("\n"))})};
Data.Text.isPrefixOf=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_bool(0==Fay$$fayToJs(["user","Text",[]],b).lastIndexOf(Fay$$fayToJs(["user","Text",[]],a),0))})}};Data.Text.intersperse=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],b).split("").join(Fay$$fayToJs(["user","Char",[]],a)))})}};
Data.Text.reverse=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a).split("").reverse().join(""))})};
Data.Text.stripSuffix=function(a){return function(b){return new Fay$$$(function(){return function(){return Fay$$_(Data.Nullable.fromNullable)(Fay$$_(Fay$$_(function(a){return function(b){return new Fay$$$(function(){var e=Fay$$jsToFay,f;f=Fay$$fayToJs(["user","Text",[]],a);var g=Fay$$fayToJs(["user","Text",[]],b);f=g.substring(g.length-f.length)==f?g.substring(0,g.length-f.length):null;return e(["nullable",[["user","Text",[]]]],f)})}})(a))(b))}()})}};
Data.Text.splitOn=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["list",[["user","Text",[]]]],Fay$$fayToJs(["user","Text",[]],b).split(Fay$$fayToJs(["user","Char",[]],a)))})}};Data.Text.putStrLn=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],console.log("%s",Fay$$fayToJs(["user","Text",[]],a))))})};Data.Text.toShortest=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_double(a).toString())})};
Data.Text.showInt=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs_int(a).toString())})};Data.Text.uncons=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Maybe",[["tuple",[["user","Char",[]],["user","Text",[]]]]]],Fay$$fayToJs(["user","Text",[]],a)[0]?{instance:"Just",slot1:[Fay$$fayToJs(["user","Text",[]],a)[0],Fay$$fayToJs(["user","Text",[]],a).slice(1)]}:{instance:"Nothing"})})};
Data.Text.head=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(!(c=Fay$$fayToJs(["user","Text",[]],a)[0]))throw Error("Data.Text.head: empty Text");return b(["user","Char",[]],c)})};Data.Text.last=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(Fay$$fayToJs(["user","Text",[]],a).length)c=Fay$$fayToJs(["user","Text",[]],a)[Fay$$fayToJs(["user","Text",[]],a).length-1];else throw Error("Data.Text.last: empty Text");return b(["user","Char",[]],c)})};
Data.Text.tail=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(Fay$$fayToJs(["user","Text",[]],a).length)c=Fay$$fayToJs(["user","Text",[]],a).slice(1);else throw Error("Data.Text.tail: empty Text");return b(["user","Text",[]],c)})};Data.Text.init=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c;if(Fay$$fayToJs(["user","Text",[]],a).length)c=Fay$$fayToJs(["user","Text",[]],a).slice(0,-1);else throw Error("Data.Text.init: empty Text");return b(["user","Text",[]],c)})};
Data.Text.map=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],[].map.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["user","Char",[]]]],a)).join(""))})}};Data.Text.toLower=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a).toLowerCase())})};
Data.Text.toUpper=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Text",[]],a).toUpperCase())})};Data.Text.concat=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["list",[["user","Text",[]]]],a).join(""))})};
Data.Text.concatMap=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],[].map.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["user","Text",[]]]],a)).join(""))})}};Data.Text.any=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_bool(0<[].filter.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],a)).length)})}};
Data.Text.all=function(a){return function(b){return new Fay$$$(function(){return Fay$$jsToFay_bool([].filter.call(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],a)).length==Fay$$fayToJs(["function",[["user","Char",[]],["bool"]]],a).length)})}};
Data.Text.maximum=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c=Fay$$fayToJs(["user","Text",[]],a);if(""===c)throw Error("Data.Text.maximum: empty string");for(var d=c[0];1<c.length;c++)c[1]>d&&(d=c[1]);return b(["user","Char",[]],d)})};Data.Text.minimum=function(a){return new Fay$$$(function(){var b=Fay$$jsToFay,c=Fay$$fayToJs(["user","Text",[]],a);if(""===c)throw Error("Data.Text.maximum: empty string");for(var d=c[0];1<c.length;c++)c[1]<d&&(d=c[1]);return b(["user","Char",[]],d)})};
Data.Maybe={};Data.Maybe.isJust=function(a){return new Fay$$$(function(){return Fay$$_(a)instanceof Prelude._Nothing?!1:!0})};Data.Maybe.isNothing=function(a){return new Fay$$$(function(){return Fay$$_(a)instanceof Prelude._Nothing?!0:!1})};
Data.Maybe.fromJust=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Nothing)return Fay$$_(Prelude.error)(Fay$$list("Maybe.fromJust: Nothing"));if(Fay$$_(a)instanceof Prelude._Just)return Fay$$_(a).slot1;throw["unhandled case in fromJust",[a]];})};Data.Maybe.fromMaybe=function(a){return function(b){return new Fay$$$(function(){var c;if(Fay$$_(b)instanceof Prelude._Nothing)c=a;else if(Fay$$_(b)instanceof Prelude._Just)c=Fay$$_(b).slot1;else throw["unhandled case",b];return c})}};
Data.Maybe.maybeToList=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Nothing)return null;if(Fay$$_(a)instanceof Prelude._Just){var b=Fay$$_(a).slot1;return Fay$$list([b])}throw["unhandled case in maybeToList",[a]];})};Data.Maybe.listToMaybe=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Prelude.Nothing;var b=Fay$$_(a);if(b instanceof Fay$$Cons)return b=b.car,Fay$$_(Prelude.Just)(b);throw["unhandled case in listToMaybe",[a]];})};
Data.Maybe.catMaybes=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.concatMap)(function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var c=Fay$$_(a).slot1;return Fay$$list([c])}return null})}))(a)})}()})};
Data.Maybe.mapMaybe=function(a){return function(b){return new Fay$$$(function(){if(null===Fay$$_(b))return null;var c=Fay$$_(b);if(c instanceof Fay$$Cons){var d=c.car,e=c.cdr;return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Maybe.mapMaybe)(a))(e)});return function(a){if(Fay$$_(a)instanceof Prelude._Nothing)return b;if(Fay$$_(a)instanceof Prelude._Just)return a=Fay$$_(a).slot1,Fay$$_(Fay$$_(Fay$$cons)(a))(b);throw["unhandled case",a];}(Fay$$_(a)(d))})}()}throw["unhandled case in mapMaybe",
[a,b]];})}};Data.Maybe.mapMaybeFB=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){var e;e=Fay$$_(b)(c);if(Fay$$_(e)instanceof Prelude._Nothing)e=d;else if(Fay$$_(e)instanceof Prelude._Just)e=Fay$$_(e).slot1,e=Fay$$_(Fay$$_(a)(e))(d);else throw["unhandled case",e];return e})}}}};
Data.Maybe.whenJust=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var c=Fay$$_(a).slot1;return Fay$$_(b)(c)}if(Fay$$_(a)instanceof Prelude._Nothing)return Fay$$_(Fay$$$_return)(Fay$$unit);throw["unhandled case in whenJust",[a,b]];})}};
Data.Maybe.whenJust$39$=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just){var c=Fay$$_(a).slot1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(b)(c)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(Prelude.Just))}if(Fay$$_(a)instanceof Prelude._Nothing)return Fay$$_(Fay$$$_return)(Prelude.Nothing);throw["unhandled case in whenJust'",[a,b]];})}};
Data.Maybe.onJust=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof Prelude._Just){var c=Fay$$_(b).slot1;return Fay$$_(Prelude.Just)(Fay$$_(a)(c))}if(Fay$$_(b)instanceof Prelude._Nothing)return Prelude.Nothing;throw["unhandled case in onJust",[a,b]];})}};Data.Maybe.joinMaybe=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof Prelude._Just&&Fay$$_(Fay$$_(a).slot1)instanceof Prelude._Just){var b=Fay$$_(Fay$$_(a).slot1).slot1;return Fay$$_(Prelude.Just)(b)}return Prelude.Nothing})};
Data.Var={};Data.Var.newSig=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Sig",[["unknown"]]],new Fay$$Sig))});Data.Var.newRef=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Ref",[["unknown"]]],new Fay$$Ref2(Fay$$fayToJs(["unknown"],a))))})};Data.Var.newVar=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Var",[["unknown"]]],new Fay$$Var(Fay$$fayToJs(["unknown"],a))))})};
Data.Var.set=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$setValue(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$fayToJs(["unknown"],b),Fay$$_)))})}};Data.Var.get=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$_(Fay$$fayToJs(["unknown"],a)).val))})};Data.Var.modify=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(a)))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(Data.Var.set)(a)))(b))})}};
Data.Var.modifyWith=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(a)))(b)))(Fay$$_(Data.Var.set)(a))})}};Data.Var.subscribe=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["function",[["unknown"],["action",[["unknown"]]]]],Fay$$subscribe(Fay$$_(Fay$$fayToJs(["unknown"],a)),Fay$$_(b))))})}};Data.Var.withUnsubscriber=function(a){return new Fay$$$(function(){return function(b){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newRef)(Prelude.Nothing)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(a))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(c)))(function(c){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Maybe.whenJust)(c)))(function(c){return Fay$$_(Fay$$_(b)(c))(a)})})})))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.set)(c))(Fay$$_(Prelude.Just)(a))))(Fay$$_(Fay$$$_return)(a))})})}})};
Data.Var.subscribeWithOld=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(a)))(Data.Var.newRef)))(function(c){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(a)))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(c)))(function(e){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.set)(c))(a)))(Fay$$_(Fay$$_(b)(e))(a))})})})})}};Data.Var.subscribeChange=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribeWithOld)(a)))(function(a){return function(d){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$neq)(a))(d))))(Fay$$_(b)(d))}})})}};
Data.Var.subscribeAndRead=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(a)))(function(c){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(b)(c)))(Fay$$_(Fay$$_(Data.Var.subscribe)(a))(b))})})}};Data.Var.subscribeChangeAndRead=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(a)))(function(c){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(b)(c)))(Fay$$_(Fay$$_(Data.Var.subscribeChange)(a))(b))})})}};
Data.Var.subscribeExclusive=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Data.Var.getBracket))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(a)))(Fay$$_(Fay$$_(Prelude.$46$)(c))(b))))(function(b){return Fay$$_(Fay$$$_return)(Fay$$list([function(b){return Fay$$_(Fay$$_(Prelude.$36$)(c))(Fay$$_(Fay$$_(Data.Var.set)(a))(b))},b]))})})})}};
Data.Var.subscribeAndReadExclusive=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Data.Var.getBracket))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribeAndRead)(a)))(Fay$$_(Fay$$_(Prelude.$46$)(c))(b))))(function(b){return Fay$$_(Fay$$$_return)(Fay$$list([function(b){return Fay$$_(Fay$$_(Prelude.$36$)(c))(Fay$$_(Fay$$_(Data.Var.set)(a))(b))},b]))})})})}};Data.Var.getBracket=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newRef)(!0)))(function(a){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))(function(b){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(a)))(function(c){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(c)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.set)(a))(!1)))(Fay$$_(Fay$$_(Fay$$then)(b))(Fay$$_(Fay$$_(Data.Var.set)(a))(!0))))})})})});
Data.Var.mapVar=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(b)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(Fay$$_(a)(c))))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(b)))(function(b){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.set)(c)))(Fay$$_(a)(b))})))(function(a){return Fay$$_(Fay$$$_return)(c)})})})})}};
Data.Var.mergeVars=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Data.Var.getBracket))(function(e){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(c)))(function(f){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(d)))(function(g){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(Fay$$_(Fay$$_(a)(f))(g))))(function(f){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(c)))(function(b){return Fay$$_(Fay$$_(Prelude.$36$)(e))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(d)))(function(c){return Fay$$_(Fay$$_(Data.Var.set)(f))(Fay$$_(Fay$$_(a)(b))(c))}))})))(function(g){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(d)))(function(b){return Fay$$_(Fay$$_(Prelude.$36$)(e))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(c)))(function(c){return Fay$$_(Fay$$_(Data.Var.set)(f))(Fay$$_(Fay$$_(a)(c))(b))}))})))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(function(b){if(Fay$$_(b)instanceof Prelude._Nothing)return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(g)(Fay$$unit)))(Fay$$_(a)(Fay$$unit)));
if(Fay$$_(b)instanceof Prelude._Just){var q=Fay$$_(b).slot1;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(f)))(function(a){var b=Fay$$_(Fay$$_(Prelude.$36$)(e));var f=Fay$$_(q)(a);if(Fay$$listLen(Fay$$_(f),2))a=Fay$$index(0,Fay$$_(f)),f=Fay$$index(1,Fay$$_(f)),a=Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.setInternal)(c))(a)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.setInternal)(d))(f)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.broadcastInternal)(c))(a)))(Fay$$_(Fay$$_(Data.Var.broadcastInternal)(d))(f))));
else throw["unhandled case",f];return b(a)})))(function(b){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$$_return))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(g)(Fay$$unit)))(Fay$$_(a)(Fay$$unit))))(Fay$$_(b)(Fay$$unit)))})}throw["unhandled case",b];}(b)))(function(a){return Fay$$_(Fay$$$_return)(Fay$$list([f,a]))})})})})})})})})}}}};
Data.Var.setInternal=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$Monad,d=Fay$$jsToFay;Fay$$_(Fay$$fayToJs(["user","Var",[["unknown"]]],a)).val=Fay$$fayToJs(["unknown"],b);return new c(d(["unknown"],void 0))})}};Data.Var.broadcastInternal=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$broadcastInternal(Fay$$_(Fay$$fayToJs(["user","Var",[["unknown"]]],a)),Fay$$fayToJs(["unknown"],b),Fay$$_)))})}};
Data.Var.mergeVars$39$=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Data.Var.mergeVars)(a))(b))(c))(d)))(function(a){if(Fay$$listLen(Fay$$_(a),2))a=Fay$$index(0,Fay$$_(a)),a=Fay$$_(Fay$$$_return)(a);else throw["unhandled case",a];return a})})}}}};Data.Var.tupleVars=new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Var.mergeVars)(function(a){return function(b){return Fay$$list([a,b])}}))(Fay$$_(Prelude.Just)(Prelude.id))});
Data.Var.tupleVars$39$=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Data.Var.tupleVars)(a))(b)))(function(a){if(Fay$$listLen(Fay$$_(a),2))a=Fay$$index(0,Fay$$_(a)),a=Fay$$_(Fay$$$_return)(a);else throw["unhandled case",a];return a})})}};
Data.Var.waitForN=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Data.Var.newSig))(function(b){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(0)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Data.Var.subscribe)(b))(Fay$$_(Prelude.$_const)(Fay$$_(Fay$$_(Data.Var.modify)(c))(function(a){return Fay$$_(Fay$$_(Fay$$add)(a))(1)})))))(function(d){return Fay$$_(Fay$$$_return)(Fay$$list([function(b){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.subscribeAndRead)(c))(function(c){return Fay$$_(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$eq)(c))(a)))(Fay$$_(Fay$$_(Fay$$then)(b))(Fay$$_(Fay$$$_return)(Fay$$unit)))})))(Fay$$_(Fay$$$_return)(Fay$$unit))},b]))})})})})};
Data.Var.waitFor=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.withUnsubscriber)(Fay$$_(Data.Var.subscribeAndRead)(a))))(function(a){return function(e){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(b)(e))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(a)(Fay$$unit)))(Fay$$_(c)(e)))}})))(function(a){return Fay$$_(Fay$$$_return)(Fay$$unit)})})}}};Data.Var.oneShot=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.withUnsubscriber)(Fay$$_(Data.Var.subscribe)(a))))(function(a){return function(d){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(a)(Fay$$unit)))(Fay$$_(b)(d))}})))(function(a){return Fay$$_(Fay$$$_return)(Fay$$unit)})})}};
Data.Var.holdSig=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(a)))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.$_void))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(b)))(Fay$$_(Data.Var.set)(a)))))(Fay$$_(Fay$$$_return)(a))})})}};Data.Function={};Data.Function.on=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return Fay$$_(Fay$$_(a)(Fay$$_(b)(c)))(Fay$$_(b)(d))})}}}};
Data.Function.fmap=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(b))(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$$_return))(a))})}};Data.Function.ap=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(a))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(b))(function(b){return Fay$$_(Fay$$$_return)(Fay$$_(a)(b))})})})}};Data.Function.$60$$42$$62$=new Fay$$$(function(){return Data.Function.ap});
var SharedTypes={_P:function(a,b){this._x=a;this._y=b}};SharedTypes._P.prototype.instance="P";SharedTypes.P=function(a){return function(b){return new Fay$$$(function(){return new SharedTypes._P(a,b)})}};SharedTypes._x=function(a){return new Fay$$$(function(){return Fay$$_(a)._x})};SharedTypes._y=function(a){return new Fay$$$(function(){return Fay$$_(a)._y})};SharedTypes._Line=function(a,b){this.slot1=a;this.slot2=b};SharedTypes._Line.prototype.instance="Line";
SharedTypes.Line=function(a){return function(b){return new Fay$$$(function(){return new SharedTypes._Line(a,b)})}};SharedTypes._Track=function(a,b,c,d){this.trackInner=a;this.trackOuter=b;this.trackStartLine=c;this.trackStartPos=d};SharedTypes._Track.prototype.instance="Track";SharedTypes.Track=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return new SharedTypes._Track(a,b,c,d)})}}}};SharedTypes.trackInner=function(a){return new Fay$$$(function(){return Fay$$_(a).trackInner})};
SharedTypes.trackOuter=function(a){return new Fay$$$(function(){return Fay$$_(a).trackOuter})};SharedTypes.trackStartLine=function(a){return new Fay$$$(function(){return Fay$$_(a).trackStartLine})};SharedTypes.trackStartPos=function(a){return new Fay$$$(function(){return Fay$$_(a).trackStartPos})};SharedTypes._Extremes=function(a,b,c,d){this.eXMin=a;this.eXMax=b;this.eYMin=c;this.eYMax=d};SharedTypes._Extremes.prototype.instance="Extremes";
SharedTypes.Extremes=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){return new SharedTypes._Extremes(a,b,c,d)})}}}};SharedTypes.eXMin=function(a){return new Fay$$$(function(){return Fay$$_(a).eXMin})};SharedTypes.eXMax=function(a){return new Fay$$$(function(){return Fay$$_(a).eXMax})};SharedTypes.eYMin=function(a){return new Fay$$$(function(){return Fay$$_(a).eYMin})};SharedTypes.eYMax=function(a){return new Fay$$$(function(){return Fay$$_(a).eYMax})};
SharedTypes._Join=function(a){this.slot1=a};SharedTypes._Join.prototype.instance="Join";SharedTypes.Join=function(a){return new Fay$$$(function(){return new SharedTypes._Join(a)})};SharedTypes._Move=function(a){this.slot1=a};SharedTypes._Move.prototype.instance="Move";SharedTypes.Move=function(a){return new Fay$$$(function(){return new SharedTypes._Move(a)})};SharedTypes._Welcome=function(a){this.slot1=a};SharedTypes._Welcome.prototype.instance="Welcome";SharedTypes.Welcome=function(a){return new Fay$$$(function(){return new SharedTypes._Welcome(a)})};
SharedTypes._Chat=function(a,b){this.slot1=a;this.slot2=b};SharedTypes._Chat.prototype.instance="Chat";SharedTypes.Chat=function(a){return function(b){return new Fay$$$(function(){return new SharedTypes._Chat(a,b)})}};SharedTypes._System=function(a){this.slot1=a};SharedTypes._System.prototype.instance="System";SharedTypes.System=function(a){return new Fay$$$(function(){return new SharedTypes._System(a)})};SharedTypes._Quit=function(a){this.slot1=a};SharedTypes._Quit.prototype.instance="Quit";
SharedTypes.Quit=function(a){return new Fay$$$(function(){return new SharedTypes._Quit(a)})};SharedTypes._Crashed=function(){};SharedTypes._Crashed.prototype.instance="Crashed";SharedTypes.Crashed=new Fay$$$(function(){return new SharedTypes._Crashed});
SharedTypes.almostEqual=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(a))(b)))return!0;if(Fay$$_(Prelude.otherwise))return function(){return new Fay$$$(function(){var c=new Fay$$$(function(){return Fay$$_(Prelude.abs)(Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(a))(b)))(Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(Prelude.abs)(b)))(Fay$$_(Prelude.abs)(a)))?b:a))});return Fay$$_(Fay$$_(Fay$$lte)(c))(1E-4)})}()})}};
SharedTypes.serializeCommand=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._Join){var b=Fay$$_(a).slot1;return Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("join\t"))))(b)}if(Fay$$_(a)instanceof SharedTypes._Quit)return b=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("quit\t"))))(b);if(Fay$$_(a)instanceof SharedTypes._Move)return b=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("move\t"))))(Fay$$_(SharedTypes.tshow)(Fay$$_(SharedTypes._x)(b)))))(Fay$$_(Data.Text.fromString)(Fay$$list("\t")))))(Fay$$_(SharedTypes.tshow)(Fay$$_(SharedTypes._y)(b)));
if(Fay$$_(a)instanceof SharedTypes._Welcome)return b=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("welcome\t"))))(Fay$$_(SharedTypes.tshowI)(b));if(Fay$$_(a)instanceof SharedTypes._Chat){var b=Fay$$_(a).slot1,c=Fay$$_(a).slot2;return Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("chat\t"))))(Fay$$_(SharedTypes.tshowI)(b))))(Fay$$_(Data.Text.fromString)(Fay$$list("\t")))))(c)}if(Fay$$_(a)instanceof
SharedTypes._System)return c=Fay$$_(a).slot1,Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Data.Text.fromString)(Fay$$list("system\t"))))(c);if(Fay$$_(a)instanceof SharedTypes._Crashed)return Fay$$_(Data.Text.fromString)(Fay$$list("crashed"));throw["unhandled case in serializeCommand",[a]];})};
SharedTypes.deserializeCommand=function(a){return new Fay$$$(function(){return function(){return Fay$$_(Fay$$_(Prelude.$36$)(function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),2)){var c=Fay$$index(0,Fay$$_(a)),d=Fay$$index(1,Fay$$_(a));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("join")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Join)(d));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("quit")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Quit)(d));
if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("welcome")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Welcome)(Fay$$_(SharedTypes.readI)(d)));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("system")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.System)(d));if(Fay$$_(Prelude.otherwise))return Prelude.Nothing}if(Fay$$listLen(Fay$$_(a),3)){var c=Fay$$index(0,Fay$$_(a)),d=Fay$$index(1,Fay$$_(a)),e=Fay$$index(2,Fay$$_(a));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("move")))))return Fay$$_(Prelude.Just)(Fay$$_(SharedTypes.Move)(Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(SharedTypes.read)(d)))(Fay$$_(SharedTypes.read)(e))));
if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("chat")))))return Fay$$_(Prelude.Just)(Fay$$_(Fay$$_(SharedTypes.Chat)(Fay$$_(SharedTypes.readI)(d)))(e));if(Fay$$_(Prelude.otherwise))return Prelude.Nothing}if(Fay$$listLen(Fay$$_(a),1)){c=Fay$$index(0,Fay$$_(a));if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(c))(Fay$$_(Data.Text.fromString)(Fay$$list("crashed")))))return Fay$$_(Prelude.Just)(SharedTypes.Crashed);Fay$$_(Prelude.otherwise)}return Prelude.Nothing})}))(Fay$$_(Fay$$_(SharedTypes.splitOn)(Fay$$_(Data.Text.fromString)(Fay$$list("\t"))))(a))}()})};
SharedTypes.tshow=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],""+Fay$$fayToJs_double(a))})};SharedTypes.tshowI=function(a){return new Fay$$$(function(){return Fay$$jsToFay(["user","Text",[]],""+Fay$$fayToJs_int(a))})};SharedTypes.splitOn=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Text.splitOn)(Fay$$_(Data.Text.head)(a)))(b)})}};
SharedTypes.read=function(a){return new Fay$$$(function(){return Fay$$jsToFay_double(parseInt(Fay$$fayToJs(["user","Text",[]],a),10))})};SharedTypes.readI=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(parseInt(Fay$$fayToJs(["user","Text",[]],a),10))})};
Fay$$objConcat(Fay$$fayToJsHash,{P:function(a,b,c){a={instance:"P"};b=Fay$$fayToJs_double(c._x);void 0!==b&&(a._x=b);c=Fay$$fayToJs_double(c._y);void 0!==c&&(a._y=c);return a},Line:function(a,b,c){a={instance:"Line"};b=Fay$$fayToJs(["user","Point",[]],c.slot1);void 0!==b&&(a.slot1=b);c=Fay$$fayToJs(["user","Point",[]],c.slot2);void 0!==c&&(a.slot2=c);return a},Track:function(a,b,c){a={instance:"Track"};b=Fay$$fayToJs(["list",[["user","Point",[]]]],c.trackInner);void 0!==b&&(a.trackInner=b);b=Fay$$fayToJs(["list",
[["user","Point",[]]]],c.trackOuter);void 0!==b&&(a.trackOuter=b);b=Fay$$fayToJs(["tuple",[["user","Point",[]],["user","Point",[]]]],c.trackStartLine);void 0!==b&&(a.trackStartLine=b);c=Fay$$fayToJs(["list",[["user","Point",[]]]],c.trackStartPos);void 0!==c&&(a.trackStartPos=c);return a},Extremes:function(a,b,c){a={instance:"Extremes"};b=Fay$$fayToJs_double(c.eXMin);void 0!==b&&(a.eXMin=b);b=Fay$$fayToJs_double(c.eXMax);void 0!==b&&(a.eXMax=b);b=Fay$$fayToJs_double(c.eYMin);void 0!==b&&(a.eYMin=b);
c=Fay$$fayToJs_double(c.eYMax);void 0!==c&&(a.eYMax=c);return a},Join:function(a,b,c){a={instance:"Join"};c=Fay$$fayToJs(["user","Text",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Move:function(a,b,c){a={instance:"Move"};c=Fay$$fayToJs(["user","Point",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Welcome:function(a,b,c){a={instance:"Welcome"};c=Fay$$fayToJs_int(c.slot1);void 0!==c&&(a.slot1=c);return a},Chat:function(a,b,c){a={instance:"Chat"};b=Fay$$fayToJs_int(c.slot1);void 0!==b&&(a.slot1=
b);c=Fay$$fayToJs(["user","Text",[]],c.slot2);void 0!==c&&(a.slot2=c);return a},System:function(a,b,c){a={instance:"System"};c=Fay$$fayToJs(["user","Text",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Quit:function(a,b,c){a={instance:"Quit"};c=Fay$$fayToJs(["user","Text",[]],c.slot1);void 0!==c&&(a.slot1=c);return a},Crashed:function(a,b,c){return{instance:"Crashed"}}});
Fay$$objConcat(Fay$$jsToFayHash,{P:function(a,b,c){return new SharedTypes._P(Fay$$jsToFay_double(c._x),Fay$$jsToFay_double(c._y))},Line:function(a,b,c){return new SharedTypes._Line(Fay$$jsToFay(["user","Point",[]],c.slot1),Fay$$jsToFay(["user","Point",[]],c.slot2))},Track:function(a,b,c){return new SharedTypes._Track(Fay$$jsToFay(["list",[["user","Point",[]]]],c.trackInner),Fay$$jsToFay(["list",[["user","Point",[]]]],c.trackOuter),Fay$$jsToFay(["tuple",[["user","Point",[]],["user","Point",[]]]],c.trackStartLine),
Fay$$jsToFay(["list",[["user","Point",[]]]],c.trackStartPos))},Extremes:function(a,b,c){return new SharedTypes._Extremes(Fay$$jsToFay_double(c.eXMin),Fay$$jsToFay_double(c.eXMax),Fay$$jsToFay_double(c.eYMin),Fay$$jsToFay_double(c.eYMax))},Join:function(a,b,c){return new SharedTypes._Join(Fay$$jsToFay(["user","Text",[]],c.slot1))},Move:function(a,b,c){return new SharedTypes._Move(Fay$$jsToFay(["user","Point",[]],c.slot1))},Welcome:function(a,b,c){return new SharedTypes._Welcome(Fay$$jsToFay_int(c.slot1))},
Chat:function(a,b,c){return new SharedTypes._Chat(Fay$$jsToFay_int(c.slot1),Fay$$jsToFay(["user","Text",[]],c.slot2))},System:function(a,b,c){return new SharedTypes._System(Fay$$jsToFay(["user","Text",[]],c.slot1))},Quit:function(a,b,c){return new SharedTypes._Quit(Fay$$jsToFay(["user","Text",[]],c.slot1))},Crashed:function(a,b,c){return new SharedTypes._Crashed}});
var Geometry={_BoundedLine:function(a,b,c,d,e,f){this.p1=a;this.p2=b;this.leftMost=c;this.rightMost=d;this.topMost=e;this.bottomMost=f}};Geometry._BoundedLine.prototype.instance="BoundedLine";Geometry.BoundedLine=function(a){return function(b){return function(c){return function(d){return function(e){return function(f){return new Fay$$$(function(){return new Geometry._BoundedLine(a,b,c,d,e,f)})}}}}}};Geometry.p1=function(a){return new Fay$$$(function(){return Fay$$_(a).p1})};Geometry.p2=function(a){return new Fay$$$(function(){return Fay$$_(a).p2})};
Geometry.leftMost=function(a){return new Fay$$$(function(){return Fay$$_(a).leftMost})};Geometry.rightMost=function(a){return new Fay$$$(function(){return Fay$$_(a).rightMost})};Geometry.topMost=function(a){return new Fay$$$(function(){return Fay$$_(a).topMost})};Geometry.bottomMost=function(a){return new Fay$$$(function(){return Fay$$_(a).bottomMost})};
Geometry.boundedLine=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof SharedTypes._P){var c=Fay$$_(b)._x,d=Fay$$_(b)._y;if(Fay$$_(a)instanceof SharedTypes._P){var e=Fay$$_(a)._x,f=Fay$$_(a)._y;return function(){var g=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.min)(e))(c)}),h=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.max)(e))(c)}),k=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.min)(f))(d)}),l=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.max)(f))(d)});
return function(){var c=new Geometry._BoundedLine;c.bottomMost=l;c.leftMost=g;c.p1=a;c.p2=b;c.rightMost=h;c.topMost=k;return c}()}()}}throw["unhandled case in boundedLine",[a,b]];})}};Geometry.hypot=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Prelude.sqrt)(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$mult)(a))(a)))(Fay$$_(Fay$$_(Fay$$mult)(b))(b)))})}};Geometry.distance=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Geometry.hypot)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(SharedTypes._x)(a)))(Fay$$_(SharedTypes._x)(b))))(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(SharedTypes._y)(a)))(Fay$$_(SharedTypes._y)(b)))})}};
Geometry.clamp=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._P){var b=Fay$$_(a)._x,c=Fay$$_(a)._y;return function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$46$)(Prelude.fromIntegral))(Prelude.round)});return Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(a)(b)))(Fay$$_(a)(c))}()}throw["unhandled case in clamp",[a]];})};
Geometry.hasPoint=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._Line){var c=Fay$$_(a).slot1,d=Fay$$_(a).slot2;if(Fay$$_(Fay$$_(Fay$$_(SharedTypes.almostEqual)(Fay$$_(SharedTypes._x)(c)))(Fay$$_(SharedTypes._x)(d))))return Fay$$_(Fay$$_(SharedTypes.almostEqual)(Fay$$_(SharedTypes._x)(b)))(Fay$$_(SharedTypes._x)(c));if(Fay$$_(Prelude.otherwise))return function(){return new Fay$$$(function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(SharedTypes._y)(c)))(Fay$$_(SharedTypes._y)(d))))(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(SharedTypes._x)(c)))(Fay$$_(SharedTypes._x)(d)))}),
f=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(SharedTypes._y)(c)))(Fay$$_(Fay$$_(Fay$$mult)(a))(Fay$$_(SharedTypes._x)(c)))});return Fay$$_(Fay$$_(SharedTypes.almostEqual)(Fay$$_(SharedTypes._y)(b)))(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$mult)(a))(Fay$$_(SharedTypes._x)(b))))(f))})}()}throw["unhandled case in hasPoint",[a,b]];})}};
Geometry.segmentHasPoint=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._Line){var c=Fay$$_(a).slot1,d=Fay$$_(a).slot2;if(Fay$$_(Fay$$_(Prelude.not)(Fay$$_(Fay$$_(Geometry.hasPoint)(a))(b))))return!1;if(Fay$$_(Prelude.otherwise))return function(){return new Fay$$$(function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Geometry.distance)(c))(d)});return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lte)(Fay$$_(Fay$$_(Geometry.distance)(c))(b)))(a)))(Fay$$_(Fay$$_(Fay$$lte)(Fay$$_(Fay$$_(Geometry.distance)(d))(b)))(a))})}()}throw["unhandled case in segmentHasPoint",
[a,b]];})}};
Geometry.hasIntersection=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof SharedTypes._Line&&Fay$$_(Fay$$_(b).slot1)instanceof SharedTypes._P){var c=Fay$$_(Fay$$_(b).slot1)._x,d=Fay$$_(Fay$$_(b).slot1)._y;if(Fay$$_(Fay$$_(b).slot2)instanceof SharedTypes._P){var e=Fay$$_(Fay$$_(b).slot2)._x,f=Fay$$_(Fay$$_(b).slot2)._y;if(Fay$$_(a)instanceof SharedTypes._Line&&Fay$$_(Fay$$_(a).slot1)instanceof SharedTypes._P){var g=Fay$$_(Fay$$_(a).slot1)._x,h=Fay$$_(Fay$$_(a).slot1)._y;if(Fay$$_(Fay$$_(a).slot2)instanceof
SharedTypes._P){var k=Fay$$_(Fay$$_(a).slot2)._x,l=Fay$$_(Fay$$_(a).slot2)._y;return function(){return new Fay$$$(function(){var n=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Fay$$sub)(g))(k)))(Fay$$_(Fay$$_(Fay$$sub)(d))(f))))(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Fay$$sub)(h))(l)))(Fay$$_(Fay$$_(Fay$$sub)(c))(e)))});return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$neq)(n))(0)))(function(){return new Fay$$$(function(){var q=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(g))(l)))(Fay$$_(Fay$$_(Fay$$mult)(h))(k))))(Fay$$_(Fay$$_(Fay$$sub)(c))(e))))(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Fay$$sub)(g))(k)))(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(c))(f)))(Fay$$_(Fay$$_(Fay$$mult)(d))(e))))}),
p=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(g))(l)))(Fay$$_(Fay$$_(Fay$$mult)(h))(k))))(Fay$$_(Fay$$_(Fay$$sub)(d))(f))))(Fay$$_(Fay$$_(Fay$$mult)(Fay$$_(Fay$$_(Fay$$sub)(h))(l)))(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(c))(f)))(Fay$$_(Fay$$_(Fay$$mult)(d))(e))))}),r=new Fay$$$(function(){return Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$divi)(q))(n)))(Fay$$_(Fay$$_(Fay$$divi)(p))(n))});return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Geometry.segmentHasPoint)(a))(r)))(Fay$$_(Fay$$_(Geometry.segmentHasPoint)(b))(r))})}())})}()}}}}throw["unhandled case in hasIntersection",
[a,b]];})}};Geometry.hasIntersectionBounded=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gte)(Fay$$_(Geometry.bottomMost)(a)))(Fay$$_(Geometry.topMost)(b))))(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gte)(Fay$$_(Geometry.rightMost)(b)))(Fay$$_(Geometry.leftMost)(b))))(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lte)(Fay$$_(Geometry.topMost)(a)))(Fay$$_(Geometry.bottomMost)(b))))(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lte)(Fay$$_(Geometry.leftMost)(a)))(Fay$$_(Geometry.rightMost)(b))))(Fay$$_(Fay$$_(Geometry.hasIntersection)(Fay$$_(Fay$$_(SharedTypes.Line)(Fay$$_(Geometry.p1)(a)))(Fay$$_(Geometry.p2)(a))))(Fay$$_(Fay$$_(SharedTypes.Line)(Fay$$_(Geometry.p1)(b)))(Fay$$_(Geometry.p2)(b)))))))})}};
Geometry.extents=function(a){return new Fay$$$(function(){return function(){var b=function(a){return function(d){return new Fay$$$(function(){if(null===Fay$$_(d))return a;var e=Fay$$_(d);if(e instanceof Fay$$Cons&&Fay$$_(e.car)instanceof SharedTypes._P){var f=Fay$$_(e.car)._x,g=Fay$$_(e.car)._y,h=e.cdr;if(Fay$$listLen(Fay$$_(a),4)){var k=Fay$$index(0,Fay$$_(a)),l=Fay$$index(1,Fay$$_(a)),n=Fay$$index(2,Fay$$_(a)),q=Fay$$index(3,Fay$$_(a));return function(){return new Fay$$$(function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.min)(f))(k)}),
c=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.min)(g))(l)}),d=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.max)(f))(n)}),e=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.max)(g))(q)});return Fay$$_(Fay$$_(Fay$$seq)(a))(Fay$$_(Fay$$_(Fay$$seq)(c))(Fay$$_(Fay$$_(Fay$$seq)(d))(Fay$$_(Fay$$_(Fay$$seq)(e))(Fay$$_(Fay$$_(b)(Fay$$list([a,c,d,e])))(h)))))})}()}}throw["unhandled case in go",[a,d]];})}};return function(){return new Fay$$$(function(){var c=Fay$$_(Fay$$_(b)(Fay$$list([1E8,1E8,
0,0])))(a);if(Fay$$listLen(Fay$$_(c),4))var d=Fay$$index(0,Fay$$_(c)),e=Fay$$index(1,Fay$$_(c)),f=Fay$$index(2,Fay$$_(c)),c=Fay$$index(3,Fay$$_(c));else throw["Irrefutable pattern failed for pattern: (eXMin, eYMin, eXMax, eYMax)",[]];var g=new SharedTypes._Extremes;g.eXMax=f;g.eXMin=d;g.eYMax=c;g.eYMin=e;return g})}()}()})};
Geometry.getSegments=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return null;var b=Fay$$_(a);if(b instanceof Fay$$Cons){var c=b.car;return function(){var b=function(a){return new Fay$$$(function(){if(null===Fay$$_(a))return Fay$$_(Prelude.error)(Fay$$list("Empty list handled in `getSegments`, this can never happen"));if(Fay$$listLen(Fay$$_(a),1)){var f=Fay$$index(0,Fay$$_(a));return Fay$$list([Fay$$_(Fay$$_(Geometry.boundedLine)(f))(c)])}f=Fay$$_(a);if(f instanceof Fay$$Cons){var g=
f.car,h=Fay$$_(f.cdr);if(h instanceof Fay$$Cons)return f=h.car,h=h.cdr,Fay$$_(Fay$$_(Fay$$cons)(Fay$$_(Fay$$_(Geometry.boundedLine)(g))(f)))(Fay$$_(b)(Fay$$_(Fay$$_(Fay$$cons)(f))(h)))}throw["unhandled case in go",[a]];})};return Fay$$_(b)(a)}()}throw["unhandled case in getSegments",[a]];})};Geometry.intersectsWithAnyBounded=function(a){return new Fay$$$(function(){return Fay$$_(Prelude.any)(Fay$$_(Geometry.hasIntersectionBounded)(a))})};Geometry.translate=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Prelude.map)(Fay$$_(Fay$$_(Geometry.translatePoint)(a))(b))})}};
Geometry.translatePoint=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof SharedTypes._P){var d=Fay$$_(c)._x,e=Fay$$_(c)._y;return Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(d))(a)))(Fay$$_(Fay$$_(Fay$$add)(e))(b))}throw["unhandled case in translatePoint",[a,b,c]];})}}};
Fay$$objConcat(Fay$$fayToJsHash,{BoundedLine:function(a,b,c){a={instance:"BoundedLine"};b=Fay$$fayToJs(["user","Point",[]],c.p1);void 0!==b&&(a.p1=b);b=Fay$$fayToJs(["user","Point",[]],c.p2);void 0!==b&&(a.p2=b);b=Fay$$fayToJs_double(c.leftMost);void 0!==b&&(a.leftMost=b);b=Fay$$fayToJs_double(c.rightMost);void 0!==b&&(a.rightMost=b);b=Fay$$fayToJs_double(c.topMost);void 0!==b&&(a.topMost=b);c=Fay$$fayToJs_double(c.bottomMost);void 0!==c&&(a.bottomMost=c);return a}});
Fay$$objConcat(Fay$$jsToFayHash,{BoundedLine:function(a,b,c){return new Geometry._BoundedLine(Fay$$jsToFay(["user","Point",[]],c.p1),Fay$$jsToFay(["user","Point",[]],c.p2),Fay$$jsToFay_double(c.leftMost),Fay$$jsToFay_double(c.rightMost),Fay$$jsToFay_double(c.topMost),Fay$$jsToFay_double(c.bottomMost))}});
var Constants={zoomIncrement:5,initialZoom:20,minZoom:5,maxZoom:40,tickRadius:0.4,pointerRadius:0.3,optionRadius:0.3,canvasPadding:0.5,crashMark:function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._P){var b=Fay$$_(a)._x,c=Fay$$_(a)._y;return function(){var a=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$mult)(0.5))(0.2)}),e=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$mult)(0.5))(0.4)}),f=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$mult)(0.5))(0.7)});return new Fay$$$(function(){return Fay$$list([Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(a)))(Fay$$_(Fay$$_(Fay$$sub)(c))(e)),
Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(f)))(Fay$$_(Fay$$_(Fay$$sub)(c))(f)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(e)))(Fay$$_(Fay$$_(Fay$$sub)(c))(a)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(0.5)))(c),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(e)))(Fay$$_(Fay$$_(Fay$$add)(c))(a)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(f)))(Fay$$_(Fay$$_(Fay$$add)(c))(f)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(a)))(Fay$$_(Fay$$_(Fay$$add)(c))(e)),
Fay$$_(Fay$$_(SharedTypes.P)(b))(Fay$$_(Fay$$_(Fay$$add)(c))(0.5)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(a)))(Fay$$_(Fay$$_(Fay$$add)(c))(e)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(f)))(Fay$$_(Fay$$_(Fay$$add)(c))(f)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(e)))(Fay$$_(Fay$$_(Fay$$add)(c))(a)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(0.5)))(c),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(e)))(Fay$$_(Fay$$_(Fay$$sub)(c))(a)),
Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(f)))(Fay$$_(Fay$$_(Fay$$sub)(c))(f)),Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(b))(a)))(Fay$$_(Fay$$_(Fay$$sub)(c))(e)),Fay$$_(Fay$$_(SharedTypes.P)(b))(Fay$$_(Fay$$_(Fay$$sub)(c))(0.5))])})}()}throw["unhandled case in crashMark",[a]];})}};FFI.Types={};FFI.SVG={};FFI.SVG.initSVG=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],SVG(Fay$$fayToJs(["user","Text",[]],a))))})};
FFI.SVG.svgSize=function(a){return function(b){return function(c){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],c).size(Fay$$fayToJs_double(a),Fay$$fayToJs_double(b))))})}}};FFI.SVG.svgGroup=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).group()))})};
FFI.SVG.groupAdd=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).add(Fay$$fayToJs(["user","Element",[]],b))))})}};FFI.SVG.svgPolygon$39$=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).polygon(Fay$$fayToJs(["list",[["tuple",[["double"],["double"]]]]],b))))})}};
FFI.SVG.svgPolygon=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(FFI.SVG.svgPolygon$39$)(a)))(Fay$$_(Prelude.map)(function(a){if(Fay$$_(a)instanceof SharedTypes._P){var c=Fay$$_(a)._x;a=Fay$$_(a)._y;return Fay$$list([c,a])}throw["unhandled case",a];}))})};FFI.SVG.svgCircle=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).circle(Fay$$fayToJs_double(b))))})}};
FFI.SVG.svgLine=function(a){return function(b){return function(c){return function(d){return function(e){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).line(Fay$$fayToJs_double(b),Fay$$fayToJs_double(c),Fay$$fayToJs_double(d),Fay$$fayToJs_double(e))))})}}}}};
FFI.SVG.setClass=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],b).attr("class",Fay$$fayToJs(["user","Text",[]],a))))})}};FFI.SVG.clipWith=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).clipWith(Fay$$fayToJs(["user","Element",[]],b))))})}};
FFI.SVG.setX=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],b).x(Fay$$fayToJs_double(a))))})}};FFI.SVG.setY=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],b).y(Fay$$fayToJs_double(a))))})}};
FFI.SVG.svgMoveFront=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).front()))})};FFI.SVG.svgRemove=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).remove()))})};
FFI.SVG.svgViewBox=function(a){return function(b){return function(c){return function(d){return function(e){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).viewbox(Fay$$fayToJs_double(b),Fay$$fayToJs_double(c),Fay$$fayToJs_double(d),Fay$$fayToJs_double(e))))})}}}}};var DotRace={FFI:{}};DotRace.FFI.Raw={};DotRace.FFI.Raw.readTrackData=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],$("#track").val()))});
DotRace.FFI.Raw.parseTrackData=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Track",[]],JSON.parse(Fay$$fayToJs(["user","Text",[]],a))))})};DotRace.FFI.Raw.addWindowEvent=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],window.addEventListener(Fay$$fayToJs(["user","Text",[]],a),Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],b))))})}};
DotRace.FFI.Raw.selectId=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],document.getElementById(Fay$$fayToJs(["user","Text",[]],a))))})};DotRace.FFI.Raw.selectClass=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["list",[["user","Element",[]]]],document.getElementsByClassName(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.addEvent=function(a){return function(b){return function(c){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$(Fay$$fayToJs(["user","Element",[]],a)).on(Fay$$fayToJs(["user","Text",[]],b),Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],c))))})}}};DotRace.FFI.Raw.eventPageX=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Event",[]],a).pageX))})};
DotRace.FFI.Raw.eventPageY=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Event",[]],a).pageY))})};DotRace.FFI.Raw.getBoundingClientRect=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Element",[]],Fay$$fayToJs(["user","Element",[]],a).getBoundingClientRect()))})};
DotRace.FFI.Raw.rectLeft=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).left))})};DotRace.FFI.Raw.rectTop=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).top))})};DotRace.FFI.Raw.getScrollTop=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).scrollTop))})};
DotRace.FFI.Raw.getScrollLeft=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_double(Fay$$fayToJs(["user","Element",[]],a).scrollLeft))})};DotRace.FFI.Raw.hide=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).remove()))})};DotRace.FFI.Raw.getURL=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],document.URL))});
DotRace.FFI.Raw.getWSConnection=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Connection",[]],new WebSocket(document.URL.replace("http","ws"))))});DotRace.FFI.Raw.onMessage=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Connection",[]],a).onmessage=Fay$$fayToJs(["function",[["user","Event",[]],["action",[["unknown"]]]]],b)))})}};
DotRace.FFI.Raw.getText=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Event",[]],a).data))})};DotRace.FFI.Raw.sendText=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Connection",[]],a).send(Fay$$fayToJs(["user","Text",[]],b))))})}};
DotRace.FFI.Raw.addChatMessage=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chat div").append("<p>"+Fay$$fayToJs(["user","Text",[]],a)+"</p>")))})};DotRace.FFI.Raw.preventDefault=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Event",[]],a).preventDefault()))})};DotRace.FFI.Raw.eventKey=function(a){return new Fay$$$(function(){return Fay$$jsToFay_int(Fay$$fayToJs(["user","Event",[]],a).keyCode)})};
DotRace.FFI.Raw.getChatMessage=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],$("#chatInput").val()))});DotRace.FFI.Raw.clearChatMessage=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chatInput").val("")))});DotRace.FFI.Raw.getSelectedValue=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],a).options[Fay$$fayToJs(["user","Element",[]],a).selectedIndex].value))})};
DotRace.FFI.Raw.setMax=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).setAttribute("max",Fay$$fayToJs_int(b))))})}};DotRace.FFI.Raw.getValue=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],Fay$$fayToJs(["user","Element",[]],a).value))})};
DotRace.FFI.Raw.setValue=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).value=Fay$$fayToJs_int(b)))})}};DotRace.FFI.Raw.setTextValue=function(a){return function(b){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).value=Fay$$fayToJs(["user","Text",[]],b)))})}};
DotRace.FFI.Raw.focusElement=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],Fay$$fayToJs(["user","Element",[]],a).focus()))})};DotRace.FFI.Raw.showDialog=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#"+Fay$$fayToJs(["user","Text",[]],a)+"").modal()))})};DotRace.FFI.Raw.getPlayerName=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["user","Text",[]],$("#inputName").val()))});
DotRace.FFI.Raw.getNumPlayers=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay_int(parseInt($("#numPlayers").val(),10)))});DotRace.FFI.Raw.setWinner=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#winner").text(Fay$$fayToJs(["user","Text",[]],a))))})};DotRace.FFI.Raw.displayThisPlayerName=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#thisPlayerName").text(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.displayThisPlayerNum=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#thisPlayerName").addClass("player-"+Fay$$fayToJs_int(a))))})};DotRace.FFI.Raw.displayGameStatus=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#gameStatus").html(Fay$$fayToJs(["user","Text",[]],a))))})};
DotRace.FFI.Raw.displayChatMsgRaw=function(a){return new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chat div").append(Fay$$fayToJs(["user","Text",[]],a))))})};DotRace.FFI.Raw.scrollChat=new Fay$$$(function(){return new Fay$$Monad(Fay$$jsToFay(["unknown"],$("#chat div").stop().animate({scrollTop:$("#chat div")[0].scrollHeight},800)))});
DotRace.FFI.eventLocation=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getBoundingClientRect)(a)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getScrollTop)(a)))(function(d){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getScrollLeft)(a)))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.rectTop)(c)))(function(f){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.rectLeft)(c)))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.eventPageX)(b)))(function(h){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.eventPageY)(b)))(function(b){return Fay$$_(Fay$$$_return)(Fay$$list([Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$sub)(h))(c)))(a),Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Fay$$sub)(b))(f)))(d)]))})})})})})})})})}};
DotRace.FFI.setMaxLimit=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(DotRace.FFI.Raw.setMax)(a))(b)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getValue)(a)))(function(c){return Fay$$_(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(SharedTypes.readI)(c)))(b)))(Fay$$_(Fay$$_(DotRace.FFI.Raw.setValue)(a))(b))}))})}};DotRace.FFI.showCrashDialog=new Fay$$$(function(){return Fay$$_(DotRace.FFI.Raw.showDialog)("crash-dialog")});
DotRace.FFI.displayPlayerJoin=new Fay$$$(function(){return Fay$$_(DotRace.FFI.displayPlayerAction)("joined")});DotRace.FFI.displayPlayerQuit=new Fay$$$(function(){return Fay$$_(DotRace.FFI.displayPlayerAction)("left")});DotRace.FFI.displayPlayerAction=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(DotRace.FFI.displaySystemMsg)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("<span class='player-"))(Fay$$_(Data.Text.showInt)(b))))("'>")))(c)))("</span> has ")))(a)))("."))})}}};
DotRace.FFI.displaySystemMsg=new Fay$$$(function(){return Fay$$_(Fay$$_(DotRace.FFI.displayChatMsg)(0))("System")});DotRace.FFI.showWinDialog=new Fay$$$(function(){return Fay$$_(DotRace.FFI.Raw.showDialog)("win-dialog")});DotRace.FFI.showLoseDialog=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.setWinner)(a)))(Fay$$_(DotRace.FFI.Raw.showDialog)("lose-dialog"))})};DotRace.FFI.displayWaitingFor=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(DotRace.FFI.Raw.displayGameStatus))(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("Waiting for <span class='player-"))(Fay$$_(Data.Text.showInt)(b))))("'>")))(a)))("</span>\u2026"))})}};
DotRace.FFI.displayChatMsg=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(DotRace.FFI.Raw.displayChatMsgRaw))(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("<p><span class='player-"))(Fay$$_(Data.Text.showInt)(a))))("'>")))(b)))("</span>: ")))(c)))("</p>"))))(DotRace.FFI.Raw.scrollChat)})}}};
DotRace.FFI.addChatMessage=DotRace.FFI.Raw.addChatMessage;DotRace.FFI.addEvent=DotRace.FFI.Raw.addEvent;DotRace.FFI.addWindowEvent=DotRace.FFI.Raw.addWindowEvent;DotRace.FFI.clearChatMessage=DotRace.FFI.Raw.clearChatMessage;DotRace.FFI.displayChatMsgRaw=DotRace.FFI.Raw.displayChatMsgRaw;DotRace.FFI.displayGameStatus=DotRace.FFI.Raw.displayGameStatus;DotRace.FFI.displayThisPlayerName=DotRace.FFI.Raw.displayThisPlayerName;DotRace.FFI.displayThisPlayerNum=DotRace.FFI.Raw.displayThisPlayerNum;
DotRace.FFI.eventKey=DotRace.FFI.Raw.eventKey;DotRace.FFI.eventPageX=DotRace.FFI.Raw.eventPageX;DotRace.FFI.eventPageY=DotRace.FFI.Raw.eventPageY;DotRace.FFI.focusElement=DotRace.FFI.Raw.focusElement;DotRace.FFI.getBoundingClientRect=DotRace.FFI.Raw.getBoundingClientRect;DotRace.FFI.getChatMessage=DotRace.FFI.Raw.getChatMessage;DotRace.FFI.getNumPlayers=DotRace.FFI.Raw.getNumPlayers;DotRace.FFI.getPlayerName=DotRace.FFI.Raw.getPlayerName;DotRace.FFI.getScrollLeft=DotRace.FFI.Raw.getScrollLeft;
DotRace.FFI.getScrollTop=DotRace.FFI.Raw.getScrollTop;DotRace.FFI.getSelectedValue=DotRace.FFI.Raw.getSelectedValue;DotRace.FFI.getText=DotRace.FFI.Raw.getText;DotRace.FFI.getURL=DotRace.FFI.Raw.getURL;DotRace.FFI.getValue=DotRace.FFI.Raw.getValue;DotRace.FFI.getWSConnection=DotRace.FFI.Raw.getWSConnection;DotRace.FFI.hide=DotRace.FFI.Raw.hide;DotRace.FFI.onMessage=DotRace.FFI.Raw.onMessage;DotRace.FFI.parseTrackData=DotRace.FFI.Raw.parseTrackData;DotRace.FFI.preventDefault=DotRace.FFI.Raw.preventDefault;
DotRace.FFI.readTrackData=DotRace.FFI.Raw.readTrackData;DotRace.FFI.rectLeft=DotRace.FFI.Raw.rectLeft;DotRace.FFI.rectTop=DotRace.FFI.Raw.rectTop;DotRace.FFI.scrollChat=DotRace.FFI.Raw.scrollChat;DotRace.FFI.selectClass=DotRace.FFI.Raw.selectClass;DotRace.FFI.selectId=DotRace.FFI.Raw.selectId;DotRace.FFI.sendText=DotRace.FFI.Raw.sendText;DotRace.FFI.setMax=DotRace.FFI.Raw.setMax;DotRace.FFI.setTextValue=DotRace.FFI.Raw.setTextValue;DotRace.FFI.setValue=DotRace.FFI.Raw.setValue;
DotRace.FFI.setWinner=DotRace.FFI.Raw.setWinner;DotRace.FFI.showDialog=DotRace.FFI.Raw.showDialog;var GameScreen={_TrackData:function(a,b,c,d,e,f,g,h,k){this.track=a;this.outerExtents=b;this.innerExtents=c;this.inner=d;this.outer=e;this.startLine=f;this.startPos=g;this.innerSegments=h;this.outerSegments=k}};GameScreen._TrackData.prototype.instance="TrackData";
GameScreen.TrackData=function(a){return function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return function(h){return function(k){return new Fay$$$(function(){return new GameScreen._TrackData(a,b,c,d,e,f,g,h,k)})}}}}}}}}};GameScreen.track=function(a){return new Fay$$$(function(){return Fay$$_(a).track})};GameScreen.outerExtents=function(a){return new Fay$$$(function(){return Fay$$_(a).outerExtents})};GameScreen.innerExtents=function(a){return new Fay$$$(function(){return Fay$$_(a).innerExtents})};
GameScreen.inner=function(a){return new Fay$$$(function(){return Fay$$_(a).inner})};GameScreen.outer=function(a){return new Fay$$$(function(){return Fay$$_(a).outer})};GameScreen.startLine=function(a){return new Fay$$$(function(){return Fay$$_(a).startLine})};GameScreen.startPos=function(a){return new Fay$$$(function(){return Fay$$_(a).startPos})};GameScreen.innerSegments=function(a){return new Fay$$$(function(){return Fay$$_(a).innerSegments})};GameScreen.outerSegments=function(a){return new Fay$$$(function(){return Fay$$_(a).outerSegments})};
GameScreen.makeTrackData=function(a){return new Fay$$$(function(){return function(){var b=new Fay$$$(function(){return Fay$$_(SharedTypes.trackInner)(a)}),c=new Fay$$$(function(){return Fay$$_(SharedTypes.trackOuter)(a)}),d=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.uncurry)(SharedTypes.Line)))(Fay$$_(SharedTypes.trackStartLine)(a))}),e=new Fay$$$(function(){return Fay$$_(SharedTypes.trackStartPos)(a)}),f=new Fay$$$(function(){return Fay$$_(Geometry.getSegments)(b)}),
g=new Fay$$$(function(){return Fay$$_(Geometry.getSegments)(c)}),h=new Fay$$$(function(){return Fay$$_(Geometry.extents)(c)}),k=new Fay$$$(function(){return Fay$$_(Geometry.extents)(b)});return function(){var l=new GameScreen._TrackData;l.inner=b;l.innerExtents=k;l.innerSegments=f;l.outer=c;l.outerExtents=h;l.outerSegments=g;l.startLine=d;l.startPos=e;l.track=a;return l}()}()})};GameScreen.drawingId="drawing";
GameScreen.drawGrid=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof GameScreen._TrackData){var c=Fay$$_(a).inner;Fay$$_(a);Fay$$_(a);var d=Fay$$_(a).outer,e=Fay$$_(a).outerExtents;Fay$$_(a);Fay$$_(a);Fay$$_(a);Fay$$_(a);return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(FFI.SVG.svgGroup)(b)))(function(a){return function(){return new Fay$$$(function(){var g=new Fay$$$(function(){return Fay$$_(SharedTypes.eXMax)(e)}),h=new Fay$$$(function(){return Fay$$_(SharedTypes.eYMax)(e)}),
k=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.round))(Fay$$_(Fay$$_(Fay$$add)(g))(1))}),l=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.round))(Fay$$_(Fay$$_(Fay$$add)(h))(1))});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.forM_)(Prelude.enumFromTo(0)(Fay$$_(Fay$$_(Fay$$add)(k))(1)))))(function(c){return function(){return new Fay$$$(function(){var d=new Fay$$$(function(){return Fay$$_(Prelude.fromIntegral)(c)});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Fay$$_(FFI.SVG.svgLine)(b))(d))(0))(d))(h)))(Fay$$_(FFI.SVG.setClass)("grid"))))(Fay$$_(FFI.SVG.groupAdd)(a))})}()})))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.forM_)(Prelude.enumFromTo(0)(Fay$$_(Fay$$_(Fay$$add)(l))(1)))))(function(c){return function(){return new Fay$$$(function(){var d=
new Fay$$$(function(){return Fay$$_(Prelude.fromIntegral)(c)});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Fay$$_(FFI.SVG.svgLine)(b))(0))(d))(g))(d)))(Fay$$_(FFI.SVG.setClass)("grid"))))(Fay$$_(FFI.SVG.groupAdd)(a))})}()})))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgPolygon)(b))(c)))(Fay$$_(FFI.SVG.setClass)("inner_grid_cover"))))(function(c){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgPolygon)(b))(d)))(function(b){return Fay$$_(Fay$$_(FFI.SVG.clipWith)(a))(b)})})))})}()})}throw["unhandled case in drawGrid",
[a,b]];})}};
GameScreen.drawStartLine=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof SharedTypes._Line&&Fay$$_(Fay$$_(b).slot1)instanceof SharedTypes._P){var c=Fay$$_(Fay$$_(b).slot1)._x,d=Fay$$_(Fay$$_(b).slot1)._y;if(Fay$$_(Fay$$_(b).slot2)instanceof SharedTypes._P){var e=Fay$$_(Fay$$_(b).slot2)._x,f=Fay$$_(Fay$$_(b).slot2)._y;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Fay$$_(FFI.SVG.svgLine)(a))(c))(d))(e))(f)))(Fay$$_(FFI.SVG.setClass)("start_line"))}}throw["unhandled case in drawStartLine",[a,
b]];})}};GameScreen.setXY=function(a){return function(b){return function(c){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(FFI.SVG.setX)(a))(c)))(Fay$$_(Fay$$_(FFI.SVG.setY)(b))(c))})}}};
GameScreen.draw=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof GameScreen._TrackData){var c=Fay$$_(a).inner;Fay$$_(a);Fay$$_(a);var d=Fay$$_(a).outer;Fay$$_(a);Fay$$_(a);var e=Fay$$_(a).startLine;Fay$$_(a);Fay$$_(a);return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(GameScreen.drawGrid)(a))(b)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(GameScreen.drawStartLine)(b))(e)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgPolygon)(b))(c)))(Fay$$_(FFI.SVG.setClass)("outline"))))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgPolygon)(b))(d)))(Fay$$_(FFI.SVG.setClass)("outline"))))(function(a){return Fay$$_(Fay$$$_return)(Fay$$unit)})})))}throw["unhandled case in draw",[a,
b]];})}};
GameScreen.drawMove=function(a){return function(b){return function(c){return new Fay$$$(function(){return function(){var d=function(a){if(Fay$$listLen(Fay$$_(a),1)&&Fay$$_(Fay$$index(0,Fay$$_(a)))instanceof SharedTypes._P){var b=Fay$$_(Fay$$index(0,Fay$$_(a)))._x,c=Fay$$_(Fay$$index(0,Fay$$_(a)))._y;return Fay$$list([b,c,b,c])}var d=Fay$$_(a);if(d instanceof Fay$$Cons&&Fay$$_(d.car)instanceof SharedTypes._P&&(b=Fay$$_(d.car)._x,c=Fay$$_(d.car)._y,d=Fay$$_(d.cdr),d instanceof Fay$$Cons&&Fay$$_(d.car)instanceof SharedTypes._P))return a=
Fay$$_(d.car)._x,d=Fay$$_(d.car)._y,Fay$$list([a,d,b,c]);throw["unhandled case",a];}(c);if(Fay$$listLen(Fay$$_(d),4))var e=Fay$$index(0,Fay$$_(d)),f=Fay$$index(1,Fay$$_(d)),g=Fay$$index(2,Fay$$_(d)),h=Fay$$index(3,Fay$$_(d));else throw["Irrefutable pattern failed for pattern: (x1, y1, x2, y2)",[]];return function(){return new Fay$$$(function(){var c=new Fay$$$(function(){return Fay$$_(Fay$$_(Data.Text.$60$$62$)("player-"))(Fay$$_(Data.Text.showInt)(b))});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Fay$$_(FFI.SVG.svgLine)(a))(e))(f))(g))(h)))(Fay$$_(FFI.SVG.setClass)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("trace "))(c)))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgCircle)(a))(Constants.tickRadius)))(Fay$$_(FFI.SVG.setClass)(Fay$$_(Fay$$_(Data.Text.$60$$62$)("tick "))(c)))))(Fay$$_(Fay$$_(GameScreen.setXY)(Fay$$_(Fay$$_(Fay$$sub)(g))(Fay$$_(Fay$$_(Fay$$divi)(Constants.tickRadius))(2))))(Fay$$_(Fay$$_(Fay$$sub)(h))(Fay$$_(Fay$$_(Fay$$divi)(Constants.tickRadius))(2))))))(Fay$$_(Fay$$$_return)(Fay$$unit)))})}()}()})}}};
GameScreen.getPosition=function(a){return function(b){return function(c){return new Fay$$$(function(){return function(){var d=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$46$)(Prelude.fromIntegral))(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.round))(function(b){return Fay$$_(Fay$$_(Fay$$divi)(b))(a)}))});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(DotRace.FFI.eventLocation)(b))(c)))(function(a){if(Fay$$listLen(Fay$$_(a),2)){var b=Fay$$index(0,Fay$$_(a));a=Fay$$index(1,Fay$$_(a));return Fay$$_(Fay$$$_return)(Fay$$list([Fay$$_(d)(b),
Fay$$_(d)(a)]))}throw["unhandled case",a];})}()})}}};
GameScreen.getNextPoint=function(a){return new Fay$$$(function(){if(Fay$$listLen(Fay$$_(a),1))return Fay$$index(0,Fay$$_(a));var b=Fay$$_(a);if(b instanceof Fay$$Cons&&Fay$$_(b.car)instanceof SharedTypes._P){var c=Fay$$_(b.car)._x,d=Fay$$_(b.car)._y,e=Fay$$_(b.cdr);if(e instanceof Fay$$Cons&&Fay$$_(e.car)instanceof SharedTypes._P)return b=Fay$$_(e.car)._x,e=Fay$$_(e.car)._y,Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(2))(c)))(b)))(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(Fay$$_(Fay$$mult)(2))(d)))(e))}throw["unhandled case in getNextPoint",[a]];
})};
GameScreen.getNeighbors=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._P){var b=Fay$$_(a)._x,c=Fay$$_(a)._y;return function(){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.concatMap)(function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.concatMap)(function(e){return new Fay$$$(function(){return Fay$$list([Fay$$_(Fay$$_(SharedTypes.P)(Fay$$_(Fay$$_(Fay$$add)(b))(a)))(Fay$$_(Fay$$_(Fay$$add)(c))(e))])})}))(Fay$$list([-1,0,
1]))})}()})}))(Fay$$list([-1,0,1]))})}()}throw["unhandled case in getNeighbors",[a]];})};GameScreen.drawCrash=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgPolygon)(a))(Fay$$_(Constants.crashMark)(b))))(Fay$$_(FFI.SVG.setClass)("crashPoint"))})}};
GameScreen.drawOpt=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof SharedTypes._P){var c=Fay$$_(b)._x,d=Fay$$_(b)._y;return function(){var b=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$divi)(Constants.optionRadius))(2)});return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgCircle)(a))(Constants.optionRadius)))(Fay$$_(FFI.SVG.setClass)("option"))))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(GameScreen.setXY)(Fay$$_(Fay$$_(Fay$$sub)(c))(b)))(Fay$$_(Fay$$_(Fay$$sub)(d))(b)))(a)))(Fay$$_(Fay$$$_return)(a))})}()}throw["unhandled case in drawOpt",
[a,b]];})}};GameScreen.removeOptions=new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectClass)("option")))(Fay$$_(Prelude.mapM_)(FFI.SVG.svgRemove))});
GameScreen.refreshOptions=function(a){return function(b){return function(c){return function(d){return new Fay$$$(function(){var e=Fay$$_(d);if(e instanceof Fay$$Cons){var f=e.car;if(Fay$$_(c)instanceof GameScreen._TrackData){Fay$$_(c);Fay$$_(c);var g=Fay$$_(c).innerSegments;Fay$$_(c);Fay$$_(c);var h=Fay$$_(c).outerSegments;Fay$$_(c);Fay$$_(c);Fay$$_(c);if(Fay$$_(a)instanceof GameScreen._GameState){Fay$$_(a);Fay$$_(a);Fay$$_(a);Fay$$_(a);var k=Fay$$_(a).gsTraces;return function(){var a=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(c)(a)))(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(e)(a)))(Fay$$_(p)(a)))})},
c=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.all)(Fay$$_(Fay$$_(Prelude.$46$)(function(b){return Fay$$_(Fay$$_(Fay$$neq)(b))(a)}))(Fay$$_(Fay$$_(Prelude.$46$)(Prelude.head))(GameScreen.ptPath))))(k)})},e=function(a){return new Fay$$$(function(){var b;a:{b=Fay$$_(d);if(b instanceof Fay$$Cons&&(b=Fay$$_(b.cdr),b instanceof Fay$$Cons)){b=b.car;b=Fay$$_(Fay$$_(Fay$$gte)(Fay$$_(Fay$$_(Geometry.distance)(a))(b)))(2);break a}b=!0}return b})},p=function(a){return new Fay$$$(function(){return function(){return new Fay$$$(function(){var b=
new Fay$$$(function(){return Fay$$_(Fay$$_(Geometry.boundedLine)(a))(f)});return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Prelude.not)(Fay$$_(Fay$$_(Geometry.intersectsWithAnyBounded)(b))(g))))(Fay$$_(Prelude.not)(Fay$$_(Fay$$_(Geometry.intersectsWithAnyBounded)(b))(h)))})}()})};return function(){return new Fay$$$(function(){var c=new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.filter)(a)))(Fay$$_(Fay$$_(Prelude.$36$)(GameScreen.getNeighbors))(Fay$$_(GameScreen.getNextPoint)(d)))});
return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$_null)(c))?Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(GameScreen.drawCrash)(b))(f)))(DotRace.FFI.showCrashDialog):Fay$$_(Fay$$_(Prelude.mapM_)(Fay$$_(GameScreen.drawOpt)(b)))(c)))(Fay$$_(Fay$$$_return)(c))})}()}()}}}throw["unhandled case in refreshOptions",[a,b,c,d]];})}}}};GameScreen._PlayerTrace=function(a,b){this.ptPath=a;this.ptExtents=b};GameScreen._PlayerTrace.prototype.instance="PlayerTrace";
GameScreen.PlayerTrace=function(a){return function(b){return new Fay$$$(function(){return new GameScreen._PlayerTrace(a,b)})}};GameScreen.ptPath=function(a){return new Fay$$$(function(){return Fay$$_(a).ptPath})};GameScreen.ptExtents=function(a){return new Fay$$$(function(){return Fay$$_(a).ptExtents})};
GameScreen.initPlayerTrace=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._P){var b=Fay$$_(a)._x,c=Fay$$_(a)._y;return Fay$$_(Fay$$_(GameScreen.PlayerTrace)(Fay$$list([a])))(Fay$$_(Fay$$_(Fay$$_(Fay$$_(SharedTypes.Extremes)(b))(b))(c))(c))}throw["unhandled case in initPlayerTrace",[a]];})};GameScreen._GameState=function(a,b,c,d,e){this.gsTraces=a;this.gsPlayerNames=b;this.gsNumPlayers=c;this.gsCurrentPlayer=d;this.gsThisPlayer=e};
GameScreen._GameState.prototype.instance="GameState";GameScreen.GameState=function(a){return function(b){return function(c){return function(d){return function(e){return new Fay$$$(function(){return new GameScreen._GameState(a,b,c,d,e)})}}}}};GameScreen.gsTraces=function(a){return new Fay$$$(function(){return Fay$$_(a).gsTraces})};GameScreen.gsPlayerNames=function(a){return new Fay$$$(function(){return Fay$$_(a).gsPlayerNames})};GameScreen.gsNumPlayers=function(a){return new Fay$$$(function(){return Fay$$_(a).gsNumPlayers})};
GameScreen.gsCurrentPlayer=function(a){return new Fay$$$(function(){return Fay$$_(a).gsCurrentPlayer})};GameScreen.gsThisPlayer=function(a){return new Fay$$$(function(){return Fay$$_(a).gsThisPlayer})};
GameScreen.findPlayerId=function(a){return function(b){return new Fay$$$(function(){return function(){var c=function(a){return function(e){return new Fay$$$(function(){if(null===Fay$$_(e)){var f=a;return 0}f=Fay$$_(e);if(f instanceof Fay$$Cons){var g=f.car,h=f.cdr,f=a;if(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(g))(b)))return f;if(Fay$$_(Prelude.otherwise))return Fay$$_(Fay$$_(c)(Fay$$_(Fay$$_(Fay$$add)(f))(1)))(h)}throw["unhandled case in go",[a,e]];})}};return Fay$$_(Fay$$_(c)(1))(a)}()})}};
GameScreen.addPlayer=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof GameScreen._GameState){var d=Fay$$_(c).gsTraces,e=Fay$$_(c).gsPlayerNames;return function(){return new Fay$$$(function(){var f=new Fay$$$(function(){return Fay$$_(Prelude.length)(d)});return function(){var g=Object.create(Fay$$_(c));g.gsTraces=Fay$$_(Fay$$_(Prelude.$43$$43$)(d))(Fay$$list([Fay$$_(GameScreen.initPlayerTrace)(Fay$$_(Fay$$_(Prelude.$33$$33$)(b))(f))]));g.gsPlayerNames=
Fay$$_(Fay$$_(Prelude.$43$$43$)(e))(Fay$$list([a]));return g}()})}()}throw["unhandled case in addPlayer",[a,b,c]];})}}};GameScreen.setThisPlayer=function(a){return function(b){return new Fay$$$(function(){var c=Object.create(Fay$$_(b));c.gsThisPlayer=a;return c})}};
GameScreen.isReady=function(a){return new Fay$$$(function(){if(Fay$$_(a)instanceof GameScreen._GameState){Fay$$_(a);var b=Fay$$_(a).gsNumPlayers;Fay$$_(a);Fay$$_(a);var c=Fay$$_(a).gsTraces;return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(Prelude.length)(c)))(b)}throw["unhandled case in isReady",[a]];})};GameScreen.thisIsCurrentPlayer=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(GameScreen.gsThisPlayer)(a)))(Fay$$_(GameScreen.gsCurrentPlayer)(a))})};
GameScreen.getCurrentTrace=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$33$$33$)(Fay$$_(GameScreen.gsTraces)(a)))(Fay$$_(Fay$$_(Fay$$sub)(Fay$$_(GameScreen.gsCurrentPlayer)(a)))(1))})};GameScreen.getNthPlayerName=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$33$$33$)(Fay$$_(GameScreen.gsPlayerNames)(a)))(Fay$$_(Fay$$_(Fay$$sub)(b))(1))})}};GameScreen.getCurrentPlayerName=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(GameScreen.getNthPlayerName)(a))(Fay$$_(GameScreen.gsCurrentPlayer)(a))})};
GameScreen.getNthTrace=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Prelude.$33$$33$)(Fay$$_(GameScreen.gsTraces)(a)))(Fay$$_(Fay$$_(Fay$$sub)(b))(1))})}};GameScreen.getCurrentPlayerTrace=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(GameScreen.getNthTrace)(a))(Fay$$_(GameScreen.gsCurrentPlayer)(a))})};
GameScreen.setIx=function(a){return function(b){return function(c){return new Fay$$$(function(){var d=Fay$$_(c);if(d instanceof Fay$$Cons){var d=d.cdr,e=b;if(1===Fay$$_(a))return Fay$$_(Fay$$_(Fay$$cons)(e))(d)}d=Fay$$_(c);if(d instanceof Fay$$Cons){var f=d.car,d=d.cdr,e=b;return Fay$$_(Fay$$_(Fay$$cons)(f))(Fay$$_(Fay$$_(Fay$$_(GameScreen.setIx)(Fay$$_(Fay$$_(Fay$$sub)(a))(1)))(e))(d))}throw["unhandled case in setIx",[a,b,c]];})}}};
GameScreen.moveCurrentPlayer=function(a){return function(b){return new Fay$$$(function(){return function(){return new Fay$$$(function(){var c=new Fay$$$(function(){return Fay$$_(GameScreen.getCurrentTrace)(b)});return function(){var d=Object.create(Fay$$_(b));d.gsTraces=Fay$$_(Fay$$_(Fay$$_(GameScreen.setIx)(Fay$$_(GameScreen.gsCurrentPlayer)(b)))(Fay$$_(Fay$$_(GameScreen.addPoint)(a))(c)))(Fay$$_(GameScreen.gsTraces)(b));return d}()})}()})}};
GameScreen.nextPlayer=function(a){return new Fay$$$(function(){var b=Object.create(Fay$$_(a));b.gsCurrentPlayer=Fay$$_(Fay$$_(Fay$$add)(Fay$$_(Fay$$_(Prelude.mod)(Fay$$_(GameScreen.gsCurrentPlayer)(a)))(Fay$$_(GameScreen.gsNumPlayers)(a))))(1);return b})};
GameScreen.initGame=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Data.Function.fmap)(GameScreen.makeTrackData))(Fay$$_(Fay$$_(Fay$$bind)(DotRace.FFI.Raw.readTrackData))(DotRace.FFI.Raw.parseTrackData))))(function(a){if(Fay$$_(a)instanceof GameScreen._TrackData){Fay$$_(a);var c=Fay$$_(a).innerExtents;Fay$$_(a);Fay$$_(a);var d=Fay$$_(a).outerExtents;Fay$$_(a);var e=Fay$$_(a).startLine,f=Fay$$_(a).startPos;Fay$$_(a);return Fay$$_(Fay$$_(Fay$$bind)(DotRace.FFI.Raw.getNumPlayers))(function(g){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Fay$$_(GameScreen.GameState)(null))(null))(g))(1))(0))))(function(g){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(Constants.initialZoom)))(function(k){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(FFI.SVG.initSVG)(GameScreen.drawingId)))(function(l){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)(GameScreen.drawingId)))(function(n){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.newVar)(null)))(function(q){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(FFI.SVG.svgCircle)(l))(Constants.pointerRadius)))(Fay$$_(FFI.SVG.setClass)("pointer"))))(function(p){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(GameScreen.setXY)(-10))(-10))(p)))(Fay$$_(Fay$$_(Fay$$bind)(DotRace.FFI.Raw.getWSConnection))(function(r){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(Fay$$_(FFI.SVG.svgViewBox)(l))(0))(0))(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(SharedTypes.eXMax)(d)))(Constants.canvasPadding)))(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(SharedTypes.eYMax)(d)))(Constants.canvasPadding))))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Data.Var.subscribe)(k)))(function(a){return Fay$$_(Fay$$_(Fay$$_(FFI.SVG.svgSize)(Fay$$_(Fay$$_(Fay$$mult)(a))(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(SharedTypes.eXMax)(d)))(Constants.canvasPadding))))(Fay$$_(Fay$$_(Fay$$mult)(a))(Fay$$_(Fay$$_(Fay$$add)(Fay$$_(SharedTypes.eYMax)(d)))(Constants.canvasPadding))))(l)})))(function(d){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(GameScreen.draw)(a))(l)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.set)(k))(Constants.initialZoom)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(n))("mousemove")))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(k)))(function(b){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(GameScreen.getPosition)(b))(n))(a)))(function(a){if(Fay$$listLen(Fay$$_(a),
2)){var b=Fay$$index(0,Fay$$_(a)),c=Fay$$index(1,Fay$$_(a));return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(q)))(function(a){return Fay$$_(Fay$$_(Fay$$_(Prelude.elem)(Fay$$_(Fay$$_(SharedTypes.P)(b))(c)))(a))?Fay$$_(Fay$$_(Fay$$then)(Fay$$_(FFI.SVG.svgMoveFront)(p)))(Fay$$_(Fay$$_(Fay$$_(GameScreen.setXY)(Fay$$_(Fay$$_(Fay$$sub)(b))(Fay$$_(Fay$$_(Fay$$divi)(Constants.pointerRadius))(2))))(Fay$$_(Fay$$_(Fay$$sub)(c))(Fay$$_(Fay$$_(Fay$$divi)(Constants.pointerRadius))(2))))(p)):Fay$$_(Fay$$_(Fay$$_(GameScreen.setXY)(-10))(-10))(p)})}throw["unhandled case",
a];})})})))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(n))("click")))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(k)))(function(b){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(GameScreen.getPosition)(b))(n))(a)))(function(a){if(Fay$$listLen(Fay$$_(a),2)){var b=Fay$$index(0,Fay$$_(a)),c=Fay$$index(1,Fay$$_(a));return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(q)))(function(a){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Prelude.elem)(Fay$$_(Fay$$_(SharedTypes.P)(b))(c)))(a))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(DotRace.FFI.Raw.sendText)(r)))(Fay$$_(Fay$$_(Prelude.$46$)(SharedTypes.serializeCommand))(SharedTypes.Move)))(Fay$$_(Fay$$_(SharedTypes.P)(b))(c))))(Fay$$_(Fay$$_(Fay$$then)(GameScreen.removeOptions))(Fay$$_(Fay$$_(Data.Var.set)(q))(null))))})}throw["unhandled case",
a];})})})))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("zoom-in")))(function(d){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(d))("click")))(function(a){return Fay$$_(Fay$$_(Data.Var.modify)(k))(GameScreen.zoomIn)})))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("zoom-out")))(function(d){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(d))("click")))(function(a){return Fay$$_(Fay$$_(Data.Var.modify)(k))(GameScreen.zoomOut)})))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(DotRace.FFI.Raw.onMessage)(r))(function(d){return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.getText)(d)))(function(d){return function(m){if(Fay$$_(m)instanceof
Prelude._Nothing)return Fay$$_(Fay$$_(Prelude.$36$)(Prelude.print))(Fay$$_(Fay$$_(Data.Text.$60$$62$)("Failed decoding message: "))(d));if(Fay$$_(m)instanceof Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._Join){var k=Fay$$_(Fay$$_(m).slot1).slot1;return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.modify)(g))(Fay$$_(Fay$$_(GameScreen.addPlayer)(k))(f))))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(c){return function(){return new Fay$$$(function(){var d=new Fay$$$(function(){return Fay$$_(Prelude.length)(Fay$$_(GameScreen.gsPlayerNames)(c))});
return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(DotRace.FFI.displayPlayerJoin)(d))(k)))(function(){return new Fay$$$(function(){var e=new Fay$$$(function(){return Fay$$_(Fay$$_(GameScreen.getNthTrace)(c))(d)});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(GameScreen.drawMove)(l))(d))(Fay$$_(GameScreen.ptPath)(e))))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(GameScreen.isReady)(c))))(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(GameScreen.gsThisPlayer)(c)))(1))?Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.displayGameStatus)("Choosing next move\u2026")))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(GameScreen.refreshOptions)(c))(l))(a))(Fay$$_(GameScreen.ptPath)(Fay$$_(GameScreen.getCurrentTrace)(c)))))(Fay$$_(Data.Var.set)(q))):
Fay$$_(Fay$$_(DotRace.FFI.displayWaitingFor)(Fay$$_(Prelude.head)(Fay$$_(GameScreen.gsPlayerNames)(c))))(1)))})}())})}()}))}if(Fay$$_(m)instanceof Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._Quit)return k=Fay$$_(Fay$$_(m).slot1).slot1,Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(a){return function(){return new Fay$$$(function(){var b=new Fay$$$(function(){return Fay$$_(Fay$$_(GameScreen.findPlayerId)(Fay$$_(GameScreen.gsPlayerNames)(a)))(k)});return Fay$$_(Fay$$_(DotRace.FFI.displayPlayerQuit)(b))(k)})}()});
if(Fay$$_(m)instanceof Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._Welcome)return m=Fay$$_(Fay$$_(m).slot1).slot1,Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.modify)(g))(Fay$$_(GameScreen.setThisPlayer)(m))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.displayThisPlayerNum)(m)))(Fay$$_(DotRace.FFI.Raw.displayGameStatus)("Waiting for players to join\u2026")));if(Fay$$_(m)instanceof Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._Move)return m=Fay$$_(Fay$$_(m).slot1).slot1,
Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.modify)(g))(Fay$$_(GameScreen.moveCurrentPlayer)(m))))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(d){return function(){return new Fay$$$(function(){var f=new Fay$$$(function(){return Fay$$_(GameScreen.getCurrentTrace)(d)});return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(GameScreen.drawMove)(l))(Fay$$_(GameScreen.gsCurrentPlayer)(d)))(Fay$$_(GameScreen.ptPath)(f))))(Fay$$_(Fay$$_(Fay$$_(Fay$$_(GameScreen.hasWon)(c))(e))(f))?Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(GameScreen.thisIsCurrentPlayer)(d))?
DotRace.FFI.showWinDialog:Fay$$_(DotRace.FFI.showLoseDialog)(Fay$$_(GameScreen.getCurrentPlayerName)(d))))(Fay$$_(DotRace.FFI.Raw.displayGameStatus)("Game over")):Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Data.Var.modify)(g))(GameScreen.nextPlayer)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(c){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(GameScreen.thisIsCurrentPlayer)(c))))(function(){return new Fay$$$(function(){var d=new Fay$$$(function(){return Fay$$_(GameScreen.getCurrentTrace)(c)});
return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Fay$$_(Fay$$_(Fay$$_(GameScreen.refreshOptions)(c))(l))(a))(Fay$$_(GameScreen.ptPath)(d))))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.when)(Fay$$_(Prelude.$_null)(a)))(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(DotRace.FFI.Raw.sendText)(r)))(Fay$$_(SharedTypes.serializeCommand)(SharedTypes.Crashed)))))(Fay$$_(Fay$$_(Data.Var.set)(q))(a))})})}())))(Fay$$_(Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(GameScreen.gsCurrentPlayer)(c)))(Fay$$_(GameScreen.gsThisPlayer)(c)))?
Fay$$_(DotRace.FFI.Raw.displayGameStatus)("Choosing next move\u2026"):Fay$$_(Fay$$_(DotRace.FFI.displayWaitingFor)(Fay$$_(GameScreen.getCurrentPlayerName)(c)))(Fay$$_(GameScreen.gsCurrentPlayer)(c)))})))})}()}));if(Fay$$_(m)instanceof Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._Chat){var n=Fay$$_(Fay$$_(m).slot1).slot1,p=Fay$$_(Fay$$_(m).slot1).slot2;return Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(a){return Fay$$_(Fay$$_(Fay$$_(DotRace.FFI.displayChatMsg)(n))(Fay$$_(Fay$$_(GameScreen.getNthPlayerName)(a))(n)))(p)})}return Fay$$_(m)instanceof
Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._Crashed?Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(GameScreen.drawCrash)(l))(Fay$$_(Fay$$_(Prelude.$36$)(Prelude.head))(Fay$$_(Fay$$_(Prelude.$36$)(GameScreen.ptPath))(Fay$$_(GameScreen.getCurrentPlayerTrace)(a))))))(DotRace.FFI.showCrashDialog)}):Fay$$_(m)instanceof Prelude._Just&&Fay$$_(Fay$$_(m).slot1)instanceof SharedTypes._System?(p=Fay$$_(Fay$$_(m).slot1).slot1,Fay$$_(DotRace.FFI.displaySystemMsg)(p)):
Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Prelude.print)("ERROR")))(Fay$$_(Prelude.print)(d))))(Fay$$_(Prelude.print)(m))}(Fay$$_(SharedTypes.deserializeCommand)(d))})})))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("joinForm")))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(a))("submit")))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.preventDefault)(a)))(Fay$$_(Fay$$_(Fay$$bind)(DotRace.FFI.Raw.getPlayerName))(function(a){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(Data.Text.length)(a)))(0))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.displayThisPlayerName)(a)))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(DotRace.FFI.Raw.sendText)(r)))(Fay$$_(Fay$$_(Prelude.$46$)(SharedTypes.serializeCommand))(SharedTypes.Join)))(a)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("join-game-dialog")))(DotRace.FFI.Raw.hide))))}))})))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("inputName")))(DotRace.FFI.Raw.focusElement)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("chatInput")))(function(a){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Fay$$_(DotRace.FFI.Raw.addEvent)(a))("keydown")))(function(a){return Fay$$_(Fay$$_(Prelude.$36$)(Fay$$_(Prelude.when)(Fay$$_(Fay$$_(Fay$$eq)(Fay$$_(DotRace.FFI.Raw.eventKey)(a)))(13))))(Fay$$_(Fay$$_(Fay$$then)(Fay$$_(DotRace.FFI.Raw.preventDefault)(a)))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(Data.Var.get)(g)))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(DotRace.FFI.Raw.getChatMessage))(function(b){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(Fay$$_(Prelude.$46$)(Fay$$_(DotRace.FFI.Raw.sendText)(r)))(SharedTypes.serializeCommand))(Fay$$_(Fay$$_(SharedTypes.Chat)(Fay$$_(GameScreen.gsThisPlayer)(a)))(b))))(DotRace.FFI.Raw.clearChatMessage)})})))})))(Fay$$_(Fay$$_(Fay$$bind)(Fay$$_(DotRace.FFI.Raw.selectId)("urlField")))(function(a){return Fay$$_(Fay$$_(Fay$$bind)(DotRace.FFI.Raw.getURL))(function(b){return Fay$$_(Fay$$_(Fay$$then)(Fay$$_(Fay$$_(DotRace.FFI.Raw.setTextValue)(a))(b)))(Fay$$_(Fay$$$_return)(Fay$$unit))})}))})))})))}))})))))}))}))})})})})})})})}throw["unhandled case",
a];})})};GameScreen.hasWon=function(a){return function(b){return function(c){return new Fay$$$(function(){if(Fay$$_(c)instanceof GameScreen._PlayerTrace){var d=Fay$$_(c).ptExtents,e=Fay$$_(c).ptPath;return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(GameScreen.encapsulates)(a))(d)))(Fay$$_(Fay$$_(GameScreen.hasWinningMove)(e))(b))}throw["unhandled case in hasWon",[a,b,c]];})}}};
GameScreen.addPoint=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(b)instanceof GameScreen._PlayerTrace){var c=Fay$$_(b).ptPath,d=Fay$$_(b).ptExtents;return Fay$$_(Fay$$_(GameScreen.PlayerTrace)(Fay$$_(Fay$$_(Fay$$cons)(a))(c)))(Fay$$_(Fay$$_(GameScreen.updateExtremes)(a))(d))}throw["unhandled case in addPoint",[a,b]];})}};
GameScreen.updateExtremes=function(a){return function(b){return new Fay$$$(function(){if(Fay$$_(a)instanceof SharedTypes._P){var c=Fay$$_(a)._x,d=Fay$$_(a)._y,e=new SharedTypes._Extremes;e.eXMin=Fay$$_(Fay$$_(Prelude.min)(c))(Fay$$_(SharedTypes.eXMin)(b));e.eXMax=Fay$$_(Fay$$_(Prelude.max)(c))(Fay$$_(SharedTypes.eXMax)(b));e.eYMin=Fay$$_(Fay$$_(Prelude.min)(d))(Fay$$_(SharedTypes.eYMin)(b));e.eYMax=Fay$$_(Fay$$_(Prelude.max)(d))(Fay$$_(SharedTypes.eYMax)(b));return e}throw["unhandled case in updateExtremes",
[a,b]];})}};GameScreen.hasWinningMove=function(a){return function(b){return new Fay$$$(function(){var c=Fay$$_(a);if(c instanceof Fay$$Cons){var d=c.car,c=Fay$$_(c.cdr);if(c instanceof Fay$$Cons)return c=c.car,Fay$$_(Fay$$_(Geometry.hasIntersection)(Fay$$_(Fay$$_(SharedTypes.Line)(c))(d)))(b)}return!1})}};GameScreen.encapsulates=function(a){return function(b){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(Fay$$_(SharedTypes.eXMin)(b)))(Fay$$_(SharedTypes.eXMin)(a))))(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$lt)(Fay$$_(SharedTypes.eYMin)(b)))(Fay$$_(SharedTypes.eYMin)(a))))(Fay$$_(Fay$$_(Fay$$and)(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(SharedTypes.eXMax)(b)))(Fay$$_(SharedTypes.eXMax)(a))))(Fay$$_(Fay$$_(Fay$$gt)(Fay$$_(SharedTypes.eYMax)(b)))(Fay$$_(SharedTypes.eYMax)(a)))))})}};
GameScreen.zoomIn=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$lt)(a))(Constants.maxZoom))?Fay$$_(Fay$$_(Fay$$add)(a))(Constants.zoomIncrement):a})};GameScreen.zoomOut=function(a){return new Fay$$$(function(){return Fay$$_(Fay$$_(Fay$$_(Fay$$gt)(a))(Constants.minZoom))?Fay$$_(Fay$$_(Fay$$sub)(a))(Constants.zoomIncrement):a})};GameScreen.main=new Fay$$$(function(){return Fay$$_(Fay$$_(DotRace.FFI.Raw.addWindowEvent)("load"))(GameScreen.initGame)});
Fay$$objConcat(Fay$$fayToJsHash,{TrackData:function(a,b,c){a={instance:"TrackData"};b=Fay$$fayToJs(["user","Track",[]],c.track);void 0!==b&&(a.track=b);b=Fay$$fayToJs(["user","Extremes",[]],c.outerExtents);void 0!==b&&(a.outerExtents=b);b=Fay$$fayToJs(["user","Extremes",[]],c.innerExtents);void 0!==b&&(a.innerExtents=b);b=Fay$$fayToJs(["list",[["user","Point",[]]]],c.inner);void 0!==b&&(a.inner=b);b=Fay$$fayToJs(["list",[["user","Point",[]]]],c.outer);void 0!==b&&(a.outer=b);b=Fay$$fayToJs(["user",
"Line",[]],c.startLine);void 0!==b&&(a.startLine=b);b=Fay$$fayToJs(["list",[["user","Point",[]]]],c.startPos);void 0!==b&&(a.startPos=b);b=Fay$$fayToJs(["list",[["user","BoundedLine",[]]]],c.innerSegments);void 0!==b&&(a.innerSegments=b);c=Fay$$fayToJs(["list",[["user","BoundedLine",[]]]],c.outerSegments);void 0!==c&&(a.outerSegments=c);return a},PlayerTrace:function(a,b,c){a={instance:"PlayerTrace"};b=Fay$$fayToJs(["list",[["user","Point",[]]]],c.ptPath);void 0!==b&&(a.ptPath=b);c=Fay$$fayToJs(["user",
"Extremes",[]],c.ptExtents);void 0!==c&&(a.ptExtents=c);return a},GameState:function(a,b,c){a={instance:"GameState"};b=Fay$$fayToJs(["list",[["user","PlayerTrace",[]]]],c.gsTraces);void 0!==b&&(a.gsTraces=b);b=Fay$$fayToJs(["list",[["user","Text",[]]]],c.gsPlayerNames);void 0!==b&&(a.gsPlayerNames=b);b=Fay$$fayToJs_int(c.gsNumPlayers);void 0!==b&&(a.gsNumPlayers=b);b=Fay$$fayToJs_int(c.gsCurrentPlayer);void 0!==b&&(a.gsCurrentPlayer=b);c=Fay$$fayToJs_int(c.gsThisPlayer);void 0!==c&&(a.gsThisPlayer=
c);return a}});
Fay$$objConcat(Fay$$jsToFayHash,{TrackData:function(a,b,c){return new GameScreen._TrackData(Fay$$jsToFay(["user","Track",[]],c.track),Fay$$jsToFay(["user","Extremes",[]],c.outerExtents),Fay$$jsToFay(["user","Extremes",[]],c.innerExtents),Fay$$jsToFay(["list",[["user","Point",[]]]],c.inner),Fay$$jsToFay(["list",[["user","Point",[]]]],c.outer),Fay$$jsToFay(["user","Line",[]],c.startLine),Fay$$jsToFay(["list",[["user","Point",[]]]],c.startPos),Fay$$jsToFay(["list",[["user","BoundedLine",[]]]],c.innerSegments),
Fay$$jsToFay(["list",[["user","BoundedLine",[]]]],c.outerSegments))},PlayerTrace:function(a,b,c){return new GameScreen._PlayerTrace(Fay$$jsToFay(["list",[["user","Point",[]]]],c.ptPath),Fay$$jsToFay(["user","Extremes",[]],c.ptExtents))},GameState:function(a,b,c){return new GameScreen._GameState(Fay$$jsToFay(["list",[["user","PlayerTrace",[]]]],c.gsTraces),Fay$$jsToFay(["list",[["user","Text",[]]]],c.gsPlayerNames),Fay$$jsToFay_int(c.gsNumPlayers),Fay$$jsToFay_int(c.gsCurrentPlayer),Fay$$jsToFay_int(c.gsThisPlayer))}});
Fay$$_(GameScreen.main,!0);
